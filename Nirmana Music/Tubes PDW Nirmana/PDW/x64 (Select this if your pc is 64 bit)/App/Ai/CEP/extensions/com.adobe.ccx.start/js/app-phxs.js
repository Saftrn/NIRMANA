iaw.apps=iaw.apps||{},iaw.apps.phxs={init:function(e,t){iaw.cepUtil.evalExtendScript('CCXWelcomeXSHost_PHXS.getInitJSON("'+t+'")',function(r){if(r){var o=null;try{var n=iaw.apps.phxs.buildHostJSON(t,r);o=JSON.parse(n,iaw.json.fnftDataReceiver)}catch(s){iaw.log.exception("Host JSON parse error: "+s.message)}e(o),iaw.localstorage.setUserItem("fnft.presetMode",!1)}})},initPresets:function(e,t){var r=iaw.cepUtil.applicationID;iaw.cepUtil.evalExtendScript("CCXWelcomeXSHost_"+r+'.getPresetJSON("'+t+'")',function(r){if(r){var o;try{var n=iaw.apps.phxs.buildHostPresetJSON(t,r);o=JSON.parse(n,iaw.json.fnftDataReceiver)}catch(s){iaw.log.exception("Host JSON parse error: "+s.message)}e(o)}})},buildHostJSON:function(e,t){var r=JSON.parse(t),o=r.envInfo,n={hostID:"PHXS",appVersion:o.appVersion,platform:o.platform,displayMode:o.displayMode,sessionGUID:o.sessionGUID,userTrackingEnabled:o.userTrackingEnabled,language:o.locale,countryCode:o.countryCode,adobeGUID:o.userGUID,accountStatus:o.subscription,accountType:o.accountType};return e&&"fnft"===e?(n.fnftSettings=this.getFNFTData(r),n.displayMode=e,iaw.store.set("phxsFNFTConfigInfo",r.fnftConfigInfo),iaw.store.set("presets",[])):(n.firstName=o.firstName,n.lastName=o.lastName,n.tabs=this.getFileTabs(r),n.appStartClockTime=o.appStartClockTime,n.secondsLeftInTrial=o.secondsLeftInTrial,n.dontShowAgain=o.startDSA,n.buttonInfo=o.buttonInfo,n.fnftEnabled=o.fnftEnabled),JSON.stringify(n)},buildHostPresetJSON:function(e,t){var r=[];if(e&&"fnft"===e){var o=JSON.parse(t);o.fnftConfigInfo=iaw.store.get("phxsFNFTConfigInfo"),r=this.getPresetArray(o)}return JSON.stringify(r)},getFNFTData:function(e){var t,r=e.fnftConfigInfo,o=e.envInfo;t=e.pixelScaleFactorList&&e.pixelScaleFactorList.pixelScaleFactorList&&e.pixelScaleFactorList.pixelScaleFactorList.map(function(e,t){return{label:e.name+(0===t?"":" ("+iaw.util.roundDecimal(e.value,2)+")"),value:e.value}})||[];var n={docSizeBounds:[3e5,3e5],units:["pixelsUnit","inchesUnit","centimetersUnit","millimetersUnit","pointsUnit","picasUnit"],resolutionUnits:["inchesUnit","centimetersUnit"],colorModes:[{mode:"bitmap",values:[1]},{mode:"grayscale",values:[8,16,32]},{mode:"RGB",values:[8,16,32]},{mode:"CMYK",values:[8,16]},{mode:"Lab",values:[8,16]}],backgroundValues:["white","black","background","transparent","custom"],backgroundColor:r.backgroundColor,pointsPerInch:r.pointsPerInch,defaultDocumentName:r.defaultNewDocName||null,colorProfileLists:o.colorProfileLists,colorSettings:r.colorSettings||{},defaultPresetSettings:r.startingPreset||null,pixelAspectRatios:t};return n},getFileTabs:function(e){var t=[],r={type:"recentfile",label:"listview_recentfiles_tab_label",listViewEnabled:"true",thumbnailViewEnabled:"true",list:e.recentFiles.list};return t.push(r),t},getPresetArray:function(e){var t=[],r=this.getRecentlyUsedPresets(e),o=e.mruTemplates.recentlyUsedTemplates;if(o){for(var n=0;n<o.length;++n)o[n].template_category="needslookup";r=r.concat(o)}r.sort(function(e,t){return e.lastUsedTime>t.lastUsedTime?-1:e.lastUsedTime<t.lastUsedTime?1:0}),t=t.concat(r);var s=e.presets;if(s.sections)for(var i=[{category:"recent",sections:["clipboard"]},{category:"saved",sections:["user"]},{category:"photo",sections:["default","photo"]},{category:"print",sections:["uspaper","europaper"]},{category:"mobile",sections:["mobile","iconography"]},{category:"film",sections:["video"]},{category:"web",sections:["web"]},{category:"art",sections:["artillustration"]}],a=0;a<i.length;++a)for(var c=0;c<i[a].sections.length;++c)for(var l=i[a].sections[c],u=0;u<s.sections.length;++u)s.sections[u].section===l&&s.sections[u].presets&&this.addPsPresetListToCCXPresetEntryList(s.sections[u].presets,i[a].category,e.fnftConfigInfo,t);return t},getRecentlyUsedPresets:function(e){var t=[];return e.mruPresets.mru&&this.addPsPresetListToCCXPresetEntryList(e.mruPresets.mru,"recent",e.fnftConfigInfo,t),t},thumbnailForPreset:function(e,t){switch(e){case"photo":return"SP_PresetPhotoDoc.png";case"europaper":case"uspaper":return"SP_PrintDoc.png";case"mobile":return"SP_PresetMobilePhoneDoc.png";case"iconography":return"SP_PresetIconographyDoc.png";case"video":return"SP_PresetFilmVideo.png";case"web":return"SP_PresetWebDoc.png";case"artillustration":return"SP_PresetArt.png";case"clipboard":return"SP_PresetClipboard.png";case"default":return"CCX_Start_DefaultThumb_Ps_Ai_Id.png";case"last":}return"SP_PresetCustom.png"},convertPsPresetToCCXPresetEntry:function(e,t,r){if("separator"!==e.name){var o=e;return o.isPreset=!0,o.id="",o.title=o.name,o.thumbnail_url="",o.mime_type="image/photoshop",o.price_prompt="",o.template_category="error",o.previews=[],"screen"===o.resolution?(o.resolution=r.screenPresetResolution.value,o.resolutionUnits=r.screenPresetResolution.units):"print"===o.resolution&&(o.resolution=r.printPresetResolution.value,o.resolutionUnits=r.printPresetResolution.units),o.template_category=t,o.thumbnail_url=this.thumbnailForPreset(o.group,o.title),o}},addPsPresetListToCCXPresetEntryList:function(e,t,r,o){for(var n=0;n<e.length;++n)if("separator"!==e[n].name){var s=this.convertPsPresetToCCXPresetEntry(e[n],t,r);s&&("clipboard"!==s.group?o.push(s):o.unshift(s))}},promptForCustomColor:function(e){var t,r,o=e,n=iaw.i18n.getLocalizedString("newdoc_color-picker_context");return e instanceof Object||(o={red:255,grain:255,blue:255,type:"RGBColor"}),t=JSON.stringify(o).replace(/"/g,'\\"'),r='"'+t+'", "'+n+'"',new Promise(function(e,t){try{iaw.cepUtil.evalExtendScript("CCXWelcomeXSHost_PHXS.openColorPicker("+r+")",function(r){if(r)try{var o=JSON.parse(r);e(o)}catch(n){t(new Error("Failed to parse result from openColorPicker",n))}e(null)})}catch(o){t(new Error("Failed to get color via color picker",o))}})},convertColorToRGB:function(e){if(!e)return new Promise(function(e,t){e({red:255,grain:255,blue:255,type:"RGBColor"})});var t=JSON.stringify(e).replace(/"/g,'\\"');return new Promise(function(e,r){try{iaw.cepUtil.evalExtendScript('CCXWelcomeXSHost_PHXS.convertColorToRGB("'+t+'")',function(t){if(t)try{var o=JSON.parse(t);e(o)}catch(n){r(new Error("Failed to parse result from convertColorToRGB",n))}r(new Error("convertColorToRGB Failed to convert color, empty result"))})}catch(o){r(new Error("convertColorToRGB Failed to convert color",o))}})},rgbFormat:function(e){return"rgb("+Math.round(e.red)+", "+Math.round(void 0!==e.grain?e.grain:e.green)+", "+Math.round(e.blue)+")"}};
//# sourceMappingURL=app-phxs.js.map
