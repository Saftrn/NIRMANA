{"version":3,"sources":["tophat.js","cepUtil.js","bootstrap.js","riotcontrol.js"],"names":["every","ar","fn","i","j","length","each","el","tophat","paths","idOrDone","optDone","loopFn","item","call","list","callback","queue","id","done","dset","delay","split","push","idOrDoneIsDone","join","setTimeout","loading","path","force","test","scriptpath","indexOf","scripts","ids","create","this","loaded","document","createElement","onload","onerror","onreadystatechange","readyState","async","src","urlArgs","body","appendChild","get","order","s","shift","p","str","ready","deps","req","missing","dep","key","window","iaw","cepUtil","oneTimeHandler","csInterface","CSInterface","isStage","applicationID","getApplicationID","events","EXTENSIONREADY","LOGPIP","kOpenRecentFile","kExecuteMenuCmd","kHostStatusChanged","REQUESTHOSTCLOSE","kOpenDropFiles","kOpenPreferences","kTrialExpired","kGetUserJSONDataRequest","kGetUserJSONDataResponse","NEWDOCFROMTEMPLATE","HOSTCLOSEFNFT","LOADEXTENSION","INTERACTIVEREADY","authenticationInfo","adobeStock","clientID","clientScope","adobeLearn","adobeAccount","imsInfo","imsInterface","IMSInterface","stageConfig","label","clientId","clientSecret","scope","redirectUri","imsServer","productionConfig","activeConfig","imsRef","imsTimeout","accessToken","accessTokenCallbacks","accessTokenInProgress","lastAccessTokenTime","Date","valueOf","needRetry","setEnvironment","mode","isIMSDataValid","event","data","handleFetchAccessToken","self","extensionId","getExtensionID","jump","clearTimeout","removeEventListener","imsFetchAccessToken","imsData","JSON","parse","access_token","log","console","stringify","getAccessToken","numCallbacks","index","accessTokenTimeout","currentTime","clearAccessToken","imsConnect","addEventListener","bind","localstorage","userID","imsGetCurrentUserIdHelper","userGUID","getIMSAccounts","imsFetchAccounts","createFetchContinueTokenCall","imsJumpClientID","imsJumpScope","url","imsFetchContinueToken","baseURL","encodeURIComponent","jumpURL","handleJumpURL","details","isStagingRedirectInEffect","answer","__adobe_cep__","DOMParser","getOSInformation","getSystemPath","SystemPath","EXTENSION","result","cep","fs","readFile","err","xmlDoc","parseFromString","configNode","getElementsByTagName","namespaces","namespace","getAttribute","properties","property","pVal","firstChild","nodeValue","ignore","imsValid","Boolean","evalExtendScript","script","evalScript","evalExtendScriptWithParams","arguments","Error","paramsArray","args","Array","prototype","slice","pop","commandName","map","arg","param","replace","sendEvent","eventType","eventData","optExtensionID","CSEvent","appId","type","dispatchEvent","getExtensionVersion","useBundleVersion","verInfo","version","sha","extensionDir","os","pathSeparator","manifestPath","fileContents","parser","extManifestElement","attributes","getNamedItem","firstElementChild","isUserSignedIn","adobeGUID","usingStageAuthentication","getIMSAccessToken","getPrimaryAccountType","accountType","accounts","accType","e","exception","message","getUIThemeColor","getHostEnvironment","appSkinInfo","panelBackgroundColor","color","addThemeChangeListener","util","setUIThemeMode","createJumpURL","getExtensionPath","performance","now","loadTime","hostData","store","Baobab","immutable","persistent","perf","logToHighBeam","set","timers","DataTime","HostData","hostID","hostIDlc","toLowerCase","loadAppScript","oncontextmenu","title","interfaceColor","red","classList","remove","loadLibrary","libraryManager","TEMPLATE_ELEMENT_TYPE","apps","init","boot","receivedHostData","jsData","json","fnftDataReceiver","initHost","fnftFakeHostData","initPresets","fnftPresetData","initTemplates","fnftFakeStockData","fnftFakeLicensedTemplates","UI","riot","mount","measure","radarVersion","radarSessionGUID","generateGUID","ingestServer","InitHost","filters","fnft","generateFilters","displayCount","parseInt","getUserItem","setUserItem","logJSON","lang","language","i18n","addFromLocalLocaleFile","evt","riotctrl","trigger","motor","start","startup","run","PHASES","Doc","Host","StockData","platform","comboCmd","comboPer","which","closeExtension","HostPresetData","templates","presetData","presetLUT","hostId","uuid","lastUsedTime","getTimezoneOffset","InteractiveTime","getTemplates","getStockData","stockData","sd","generateDefaultStockData","LicensedData","getLicensedTemplates","then","licensedTemplates","TemplateFixup","licensedTemplatesLUT","templateCount","tIndex","clone","presets","forEach","preset","isPreset","getIdByElementRef","elementRef","stockTemplate","licensedDataIndex","undefined","licensedData","modified","licensedTime","thumbnail_url","template_category","templateIds","concat","filter","template","pos","templateLUT","Done","activeItem","querySelector","focus","JSLibLateLoad","loadExternalScript","scriptTag","Ingest","analytics","config","LoadTime","preventDefault","h","parseQueryString","location","hash","burnt","RETROACTIVE","on","name","ctx","apply","once","off","evtArr","evts","liveEvents","len"],"mappings":"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","file":"fnft-boot.js","sourcesContent":["(function() {\n\tvar push = 'push';\n\tvar readyState = 'readyState';\n\tvar onreadystatechange = 'onreadystatechange';\n\t// var head = document.getElementsByTagName('head')[0];\n\tvar list = {};\n\tvar ids = {};\n\tvar delay = {};\n\tvar scripts = {};\n\tvar scriptpath;\n\tvar urlArgs;\n\n\tfunction every(ar, fn) {\n\t\tfor (var i = 0, j = ar.length; i < j; ++i) {\n\t\t\tif (!fn(ar[i])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn 1;\n\t}\n\n\tfunction each(ar, fn) {\n\t\tevery(ar, function(el) {\n\t\t\tfn(el);\n\t\t\treturn 1;\n\t\t});\n\t}\n\n\tfunction tophat(paths, idOrDone, optDone) {\n\t\tpaths = paths[push] ? paths : [paths];\n\t\tvar idOrDoneIsDone = idOrDone && idOrDone.call,\n\t\t\tdone = idOrDoneIsDone ? idOrDone : optDone,\n\t\t\tid = idOrDoneIsDone ? paths.join('') : idOrDone,\n\t\t\tqueue = paths.length;\n\n\t\tfunction loopFn(item) {\n\t\t\treturn item.call ? item() : list[item];\n\t\t}\n\t\tfunction callback() {\n\t\t\tif (!--queue) {\n\t\t\t\tlist[id] = 1;\n\t\t\t\tdone && done();\n\t\t\t\tfor (var dset in delay) {\n\t\t\t\t\tevery(dset.split('|'), loopFn) && !each(delay[dset], loopFn) && (delay[dset] = []);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsetTimeout(function() {\n\t\t\teach(paths, function loading(path, force) {\n\t\t\t\tif (path === null) return callback();\n\n\t\t\t\tif (!force && !/^https?:\\/\\//.test(path) && scriptpath) {\n\t\t\t\t\tpath = (path.indexOf('.js') === -1) ? scriptpath + path + '.js' : scriptpath + path;\n\t\t\t\t}\n\n\t\t\t\tif (scripts[path]) {\n\t\t\t\t\tif (id) ids[id] = 1;\n\t\t\t\t\treturn (scripts[path] == 2) ? callback() : setTimeout(function() { loading(path, true); }, 0);\n\t\t\t\t}\n\n\t\t\t\tscripts[path] = 1;\n\t\t\t\tif (id) ids[id] = 1;\n\t\t\t\tcreate(path, callback);\n\t\t\t});\n\t\t}, 0);\n\t\treturn this;\n\t}\n\n\tfunction create(path, fn) {\n\t\tvar el = document.createElement('script'), loaded;\n\t\tel.onload = el.onerror = el[onreadystatechange] = function() {\n\t\t\tif ((el[readyState] && !(/^c|loade/.test(el[readyState]))) || loaded) return;\n\t\t\tel.onload = el[onreadystatechange] = null;\n\t\t\tloaded = 1;\n\t\t\tscripts[path] = 2;\n\t\t\tfn();\n\t\t};\n\t\tel.async = 1;\n\t\tel.src = urlArgs ? path + (path.indexOf('?') === -1 ? '?' : '&') + urlArgs : path;\n\t\tdocument.body.appendChild(el);\n\t\t// head.appendChild(el);\n\t}\n\n\ttophat.get = create;\n\n\ttophat.order = function(scripts, id, done) {\n\t\t(function callback(s) {\n\t\t\ts = scripts.shift();\n\t\t\t!scripts.length ? tophat(s, id, done) : tophat(s, callback);\n\t\t}());\n\t};\n\n\ttophat.path = function(p) {\n\t\tscriptpath = p;\n\t};\n\n\ttophat.urlArgs = function(str) {\n\t\turlArgs = str;\n\t};\n\n\ttophat.ready = function(deps, ready, req) {\n\t\tdeps = deps[push] ? deps : [deps];\n\t\tvar missing = [];\n\t\t!each(deps, function(dep) {\n\t\t\tlist[dep] || missing[push](dep);\n\t\t}) && every(deps, function(dep) {\n\t\t\treturn list[dep];\n\t\t}) ? ready() : ! function(key) {\n\t\t\tdelay[key] = delay[key] || [];\n\t\t\tdelay[key][push](ready);\n\t\t\treq && req(missing);\n\t\t}(deps.join('|'));\n\t\treturn tophat;\n\t};\n\n\ttophat.done = function(idOrDone) {\n\t\ttophat([null], idOrDone);\n\t};\n\n\twindow.tophat = tophat;\n}());\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/**\n * Simple singleton style container so all CEP related stuff has a centralized point.\n */\nvar iaw = iaw || { };\n\niaw.cepUtil = {\n\t/**\n\t * Encapsulated interfaces\n\t */\n\toneTimeHandler: false,\n\tcsInterface: (window.__adobe_cep__) ? new CSInterface()  : null,\n\tisStage: null,\n\n\t/**\n\t * Hosting application and extension data\n\t */\n\tapplicationID:\t(window.__adobe_cep__) ? new CSInterface().getApplicationID() : 'SIMU',\n\n\t/**\n\t * Events sent to the hosting application\n\t */\n\tevents: {\n\t\tEXTENSIONREADY:\t\t\t\t'com.adobe.ccx.start.extensionReady',\n\t\tLOGPIP:\t\t\t\t\t\t'com.adobe.ccx.start.LOGPIP',\n\t\tkOpenRecentFile:\t\t\t'com.adobe.ccx.start.handleRecentFileOpen',\n\t\tkExecuteMenuCmd:\t\t\t'com.adobe.ccx.start.handleExecuteMenuCommand',\n\t\tkHostStatusChanged: \t\t'com.adobe.ccx.start.hostStatusChanged',\n\t\tREQUESTHOSTCLOSE:\t\t\t'com.adobe.ccx.start.requestHostClose',\n\t\tkOpenDropFiles:\t\t\t\t'com.adobe.ccx.start.handleDropFileOpen',\n\t\tkOpenPreferences:\t\t\t'com.adobe.ccx.start.handleOpenPreferences',\n\t\tkTrialExpired:\t\t\t\t'com.adobe.ccx.start.trialExpired',\n\t\tkGetUserJSONDataRequest: \t'com.adobe.ccx.start.getCCXUserJSONData.request',\n\t\tkGetUserJSONDataResponse: \t'com.adobe.ccx.start.getCCXUserJSONData.response',\n\t\tNEWDOCFROMTEMPLATE:\t\t\t'com.adobe.ccx.fnft.newDocFromTemplate',\n\t\tHOSTCLOSEFNFT:\t\t\t\t'com.adobe.ccx.fnft.hostRequestsClose',\n\t\tLOADEXTENSION:\t\t\t\t'com.adobe.extension.loadExtension',\n\t\tINTERACTIVEREADY: \t\t\t'com.adobe.extension.interactiveReady'\n\t},\n\n\t/**\n\t * params for jump URL authentication\n\t */\n\tauthenticationInfo: {\n\t\tadobeStock:\t{\n\t\t\tclientID:\t\t'AdobeStockClient1',\n\t\t\tclientScope:\t'AdobeID,openid,creative_cloud,read_organizations,gnav,additional_info.address.mail_to,sao.stock'\n\t\t},\n\t\tadobeLearn: {\n\t\t\tclientID:\t\t'adobedotcom2',\n\t\t\tclientScope :\t'creative_cloud,AdobeID,openid,gnav,read_organizations,additional_info.projectedProductContext'\n\t\t},\n\t\tadobeAccount: {\n\t\t\tclientID:\t\t'adobedotcom2',\n\t\t\tclientScope:\t'creative_cloud,AdobeID,openid,gnav,read_organizations,additional_info.projectedProductContext'\n\t\t}\n\t},\n\n\t/**\n\t * IMS configuration info\n\t */\n\timsInfo: {\n\t\timsInterface: (window.__adobe_cep__) ? new IMSInterface() : null,\n\n\t\tstageConfig: {\n\t\t\tlabel:\t\t\t'Stage',\n\t\t\tclientId:\t\t'CCXInAppWelcome',\n\t\t\tclientSecret:\t'2625f91d-efa1-4685-a64d-eb36ad123f09',\n\t\t\tscope:\t\t\t'openid,AdobeID,creative_cloud',\n\t\t\tredirectUri:\t'https://oobe.adobe.com',\n\t\t\timsServer:\t\t'ims-na1-stg1.adobelogin.com'\n\t\t},\n\n\t\tproductionConfig: {\n\t\t\tlabel:\t\t\t'Production',\n\t\t\tclientId:\t\t'CCXInAppWelcome',\n\t\t\tclientSecret:\t'75606424-3628-4f70-82fb-9a1bf5dfb6b5',\n\t\t\tscope:\t\t\t'openid,AdobeID,creative_cloud',\n\t\t\tredirectUri:\t'https://oobe.adobe.com',\n\t\t\timsServer:\t\t'ims-na1.adobelogin.com'\n\t\t},\n\t\tactiveConfig:\t\t\tnull,\n\t\timsRef:\t\t\t\t\tnull,\n\t\timsTimeout:\t\t\t\tnull,\n\t\taccessToken:\t\t\tnull,\n\t\taccessTokenCallbacks:\t[],\n\t\taccessTokenInProgress:\tfalse,\n\t\tlastAccessTokenTime: \tnew Date().valueOf(),\n\t\tneedRetry: true,\n\n\t\t/**\n \t\t * Set server environment for IMS.\n\t\t *\n\t\t * @param mode          either 'stage' or 'prod'\n\t\t */\n\t\tsetEnvironment: function( mode ) {\n\n\t\t\tthis.activeConfig = (mode === 'stage') ? this.stageConfig : this.productionConfig;\n\t\t},\n\n\t\t/**\n\t\t * Check to make sure the data event is valid.\n\t\t *\n\t\t * @param event         object containing the access token and other IMS data\n\t\t */\n\t\tisIMSDataValid: function( event ) {\n\n\t\t\treturn ( event && event.data && event.data !== '');\n\t\t},\n\n\t\t/**\n\t\t * Async callback for returning the IMS token.\n\t\t *\n\t\t * @param event         object containing the access token and other IMS data\n\t\t */\n\t\thandleFetchAccessToken: function(event) {\n\t\t\tvar self = this;\n\t\t\tif (event && (event.extensionId !== iaw.cepUtil.getExtensionID())) {\n\t\t\t\t//Should filter out IMS events from other CEP extensions, like photoshop preview.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (event && event.data && event.data.jump) {\n\t\t\t\t// Should filter out IMS jump event\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( self.imsTimeout ) {\n\t\t\t\tclearTimeout( self.imsTimeout );\n\t\t\t\tself.imsTimeout = null;\n\t\t\t}\n//            iaw.log.debug('Handling fetch access token callback: ' + JSON.stringify(event));\n\n\t\t\t// clear the event listener\n\t\t\tself.imsInterface.removeEventListener( self.imsInterface.events.imsFetchAccessToken, self.handleFetchAccessToken );\n\n\t\t\t// setup access token\n\t\t\t// support both string and object type, because CEP 6.0 takes\n\t\t\t// event.data as an object, CEP 6.1 mainline takes it as a string\n\t\t\t// at the moment. Not sure it's a potential bug or required change\n\t\t\t// in CEP, but Radar should handle both cases.\n\t\t\tif ( self.isIMSDataValid(event) ) {\n\t\t\t\tswitch (typeof event.data) {\n\t\t\t\t\tcase 'string':\n\t\t\t\t\t\tvar imsData = JSON.parse(event.data);\n\t\t\t\t\t\tself.accessToken = (imsData && imsData.access_token) ? imsData.access_token : null;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'object':\n\t\t\t\t\t\tself.accessToken = event.data.access_token || null;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tself.accessToken = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (!self.accessToken) {\n\t\t\t\t\tiaw.log.console('IMS response event: ' + JSON.stringify(event));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tiaw.log.console('Failed to get access token: ' + JSON.stringify(event));\n\t\t\t}\n\n\t\t\t// clear in progress flag...\n\t\t\tself.accessTokenInProgress = false;\n\t\t\tiaw.log.console('IMS accessToken is : ' + self.accessToken);\n\n\t\t\tif (self.accessToken === null && self.needRetry) {\n\t\t\t\t// Probably host app hasn't loaded IMS native library yet and it's related to the sequence of loading navtive libraries in host app.\n\t\t\t\t// So have to retry once for the very first fetch token if it fails.\n\t\t\t\t// Ideally, host app needs to adjust the sequence of native libraries. But to be releastic, such workaround is not avoidable.\n\t\t\t\tself.needRetry = false;\n\t\t\t\tiaw.cepUtil.imsInfo.getAccessToken();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// handle all the token requests that may have come in while\n\t\t\t// we were in the fetching process\n\t\t\tvar numCallbacks = self.accessTokenCallbacks.length;\n\n\t\t\tif ( numCallbacks ) {\n\t\t\t\tself.lastAccessTokenTime = new Date().valueOf();\n\t\t\t\tfor ( var index = 0; index < numCallbacks; ++index ) {\n\t\t\t\t\tvar callback = self.accessTokenCallbacks[index];\n\n\t\t\t\t\tif ( callback ) { callback(self.accessToken); }\n\t\t\t\t}\n\t\t\t\tself.accessTokenCallbacks = [];\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Handle timeout for access token fetch.\n\t\t */\n\t\taccessTokenTimeout: function() {\n\n\t\t\tiaw.log.console('IMS access token fetch has timed out');\n\t\t\tiaw.cepUtil.imsInfo.imsTimeout = null;\n\t\t\tiaw.cepUtil.imsInfo.handleFetchAccessToken(null);\n\t\t},\n\n\t\t/**\n\t\t * Retrieve the IMS access token.\n\t\t *\n\t\t * @param callback          function to call upon completion\n\t\t * @return A string containing the access token.\n\t\t */\n\t\tgetAccessToken: function( callback ) {\n\n\t\t\tvar self = this;\n\t\t\t// make sure we have the configuration setup - if not\n\t\t\t// the set the default to the production configuration\n\t\t\tif ( !self.activeConfig ) { self.activeConfig = self.productionConfig; }\n\n\t\t\t// make sure we are not already in progress as this is\n\t\t\t// an async exercise when getting the token\n\t\t\tif ( !self.accessTokenInProgress ) {\n\t\t\t\t// Clear the expired access token\n\t\t\t\tvar currentTime = new Date().valueOf();\n\t\t\t\tif (currentTime - self.lastAccessTokenTime >= 3600 * 24 * 1000) {\n\t\t\t\t\tiaw.log.console('Clear expired access token.');\n\t\t\t\t\tself.clearAccessToken();\n\t\t\t\t}\n\t\t\t\tif ( self.accessToken && self.accessToken.length !== 0 && callback ) {\n\t\t\t\t\tcallback(self.accessToken);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tself.accessTokenInProgress = true;\n\t\t\t\tif (callback) {\n\t\t\t\t\tself.accessTokenCallbacks.push(callback);\n\t\t\t\t}\n\n\t\t\t\t// create the IMS reference object\n\t\t\t\tif ( !self.imsRef && self.imsInterface ) {\n\t\t\t\t\tself.imsRef = self.imsInterface.imsConnect( self.activeConfig.clientId );\n\t\t\t\t}\n\n\t\t\t\t// set the event listener for getting the access token\n\t\t\t\t// this will cause the specified handler function to fire.\n\t\t\t\t// need to bind this so that 'this' in callback is exact the same.\n\t\t\t\tself.imsInterface.addEventListener( self.imsInterface.events.imsFetchAccessToken,\n\t\t\t\t\t(function( event ) {\n\t\t\t\t\t\tthis.handleFetchAccessToken( event );\n\t\t\t\t\t}).bind(this));\n\n\t\t\t\tif (iaw.localstorage.userID) {\n\t\t\t\t\tself.imsInterface.imsFetchAccessToken(\tself.imsRef,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.activeConfig.clientId,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.activeConfig.clientSecret,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tiaw.localstorage.userID,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.activeConfig.redirectUri,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.activeConfig.scope);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// get the currently logged in user's Adobe GUID to send to IMS\n\t\t\t\t\tself.imsInterface.imsGetCurrentUserIdHelper( function(userGUID) {\n\t\t\t\t\t\tif (userGUID && userGUID.length > 0) {\n\t\t\t\t\t\t\tself.imsInterface.imsFetchAccessToken(\tself.imsRef,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.activeConfig.clientId,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.activeConfig.clientSecret,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tuserGUID,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.activeConfig.redirectUri,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.activeConfig.scope);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif ( self.imsTimeout ) {\n\t\t\t\t\tclearTimeout( self.imsTimeout );\n\t\t\t\t}\n\n\t\t\t\t// If IMS doesn't respond in 10s, assume something went wrong\n\t\t\t\tself.imsTimeout = setTimeout(self.accessTokenTimeout, 10000);\n\t\t\t}\n\t\t\telse { // token running so just push the callback for later\n\t\t\t\tself.accessTokenCallbacks.push(callback);\n\t\t\t}\n\t\t},\n\n\t\tgetIMSAccounts: function() {\n\n\t\t\tvar self = this;\n\t\t\t// make sure we have the configuration setup - if not\n\t\t\t// the set the default to the production configuration\n\t\t\tif ( !self.activeConfig ) { self.activeConfig = self.productionConfig; }\n\n\t\t\t// create the IMS reference object\n\t\t\tif ( !self.imsRef && self.imsInterface ) {\n\t\t\t\tself.imsRef = self.imsInterface.imsConnect( self.activeConfig.clientId );\n\t\t\t}\n\n\t\t\t//fetch the accounts with the client ID\n\t\t\treturn self.imsInterface.imsFetchAccounts(self.imsRef, self.activeConfig.clientId);\n\t\t},\n\n\t\t/**\n\t\t * Clear access token.\n\t\t */\n\t\tclearAccessToken: function() {\n\t\t\tthis.accessToken = null;\n\t\t},\n\n\t\t/**\n\t\t * Handle the jump continue token call to get the authenicated URL.\n\t\t *\n\t\t * @param imsJumpClientID           client ID\n\t\t * @param imsJumpScope              client scope parameters\n\t\t * @param url                       base URL\n\t\t * @param callback                  completion callback\n\t\t */\n\t\tcreateFetchContinueTokenCall: function(imsJumpClientID, imsJumpScope, url, callback) {\n\n\t\t\tiaw.log.console('createFetchContinueTokenCall attempting SSO workflows');\n\n\t\t\tthis.imsInterface.addEventListener(this.imsInterface.events.imsFetchContinueToken, callback);\n\t\t\tvar baseURL = encodeURIComponent(url);\n\n\t\t\tthis.imsInterface.imsFetchContinueToken(this.imsRef,\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.accessToken,\n\t\t\t\t\t\t\t\t\t\t\t\t\timsJumpClientID,\n\t\t\t\t\t\t\t\t\t\t\t\t\tbaseURL,\n\t\t\t\t\t\t\t\t\t\t\t\t\timsJumpScope,\n\t\t\t\t\t\t\t\t\t\t\t\t\t'token',\n\t\t\t\t\t\t\t\t\t\t\t\t\t'');\n\t\t},\n\n\t\t/**\n\t\t * Create an authenicated jump URL.\n\t\t *\n\t\t * @param imsJumpClientID           client ID\n\t\t * @param imsJumpScope              client scope parameters\n\t\t * @param url                       base URL\n\t\t * @param callback                  completion callback\n\t\t */\n\t\tjumpURL: function(imsJumpClientID, imsJumpScope, url, callback) {\n\n\t\t\tvar self = this;\n\t\t\tvar handleJumpURL = function(event) { //eslint-disable-line func-style\n\t\t\t\tself.imsInterface.removeEventListener(self.imsInterface.events.imsFetchContinueToken, handleJumpURL);\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tcallback((self.isIMSDataValid(event) && event.data.details.jump) ? event.data.details.jump : url);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tiaw.log.console('Attempting SSO workflows for url ' + url);\n\t\t\tthis.createFetchContinueTokenCall(imsJumpClientID, imsJumpScope, url, handleJumpURL);\n\t\t},\n\n\t\t/**\n\t\t * Detect IMS environment.\n\t\t * @return true if IMS env is redirected to stage, otherwise false.\n\t\t */\n\t\tisStagingRedirectInEffect: function() {\n\n\t\t\tvar answer = false;\n\n\t\t\tif (!window.__adobe_cep__ || !window.DOMParser) { return answer; }\n\t\t\ttry {\n\t\t\t\tvar csInterface = new CSInterface();\n\t\t\t\tvar path = csInterface.getOSInformation().indexOf('Win') >= 0 ?\n\t\t\t\t\t\t\t\t\t\tcsInterface.getSystemPath(SystemPath.EXTENSION) + '\\\\..\\\\..\\\\..\\\\..\\\\..\\\\Adobe\\\\Adobe Creative Cloud\\\\C3Config.xml' :\n\t\t\t\t\t\t\t\t\t\t'/Applications/Utilities/Adobe Creative Cloud/C3Config.xml';\n\t\t\t\tvar result = window.cep.fs.readFile(path);\n\n\t\t\t\tif (0 !== result.err) {\n\t\t\t\t\treturn answer;\n\t\t\t\t}\n\n\t\t\t\tvar xmlDoc\t\t= new DOMParser().parseFromString(result.data, 'text/xml');\n\t\t\t\tvar configNode\t= xmlDoc.getElementsByTagName('C3Config')[0].getElementsByTagName('config')[0];\n\n\t\t\t\tif (configNode) {\n\t\t\t\t\tvar namespaces = configNode.getElementsByTagName('namespace');\n\n\t\t\t\t\tfor (var index = 0; index < namespaces.length; index++) {\n\t\t\t\t\t\tvar namespace = namespaces[index];\n\n\t\t\t\t\t\tif (namespace && namespace.getAttribute('name') === 'accc.container') {\n\t\t\t\t\t\t\tvar properties = namespace.getElementsByTagName('property');\n\n\t\t\t\t\t\t\tfor (var i=0; i< properties.length; i++) {\n\t\t\t\t\t\t\t\tvar property = properties[i];\n\n\t\t\t\t\t\t\t\tif (property && property.getAttribute('name') === 'IMS_ENV') {\n\t\t\t\t\t\t\t\t\t// We found the IMS environment setting. See if stage redirection is in effect.\n\t\t\t\t\t\t\t\t\tvar pVal = property.firstChild.nodeValue;\n\n\t\t\t\t\t\t\t\t\tif (pVal === 'STG') {\n\t\t\t\t\t\t\t\t\t\tanswer = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (ignore) {\n\t\t\t\t// ignore catches\n\t\t\t}\n\t\t\treturn answer;\n\t\t}\n\t}, // end imsInfo container\n\n\t/**\n\t * Indicate IMS operations are valid.\n\t *\n\t * @return boolean value indicating true if IMS is available, false otherwise\n\t */\n\timsValid: function() {\n\n\t\treturn Boolean(this.imsInfo.imsInterface);\n\t},\n\n\t/**\n\t * Execute an ExtendScript DOM script.\n\t *\n\t * @param script        script to execute\n\t * @param callback      completion callback method\n\t */\n\tevalExtendScript: function(script, callback) {\n\n\t\t// make sure we have a callback\n\t\tif ( !callback ) {\n\t\t\tcallback = function(result) { };\n\t\t}\n\n\t\t// call CEP ExtendScript processor\n\t\tif ( window.__adobe_cep__ ) {\n\t\t\twindow.__adobe_cep__.evalScript( script, callback );\n\t\t}\n\t\telse {\n\t\t\tcallback( null );\n\t\t}\n\t},\n\n\t/**\n\t * Evaluate an extend script after first building the string from a command name and zero or more parameters\n\t * The last argument must be a callback\n\t *\n\t * If a param is an object, it will use JSON.stringify\n\t * That JSON, and other string params, will be escaped properly\n\t *\n\t * example:\n\t * iaw.cepUtil.evalExtendScriptWithParams('CCXWelcomeXSHost_PHXS.createDocumentFromTemplate',\n\t *    tempObj, docName, showDialog, iaw.fnft.closeExtOnStatus)\n\t *\n\t * @param {string} commandName\n\t * @param {object|string|number=} param optional, zero or more\n\t * @param {function} callback final argument must be a callback\n\t */\n\tevalExtendScriptWithParams: function() {\n\t\tif (arguments.length < 2) {\n\t\t\tthrow new Error('evalExtendScriptWithParams needs at least two arguments: script and callback');\n\t\t}\n\n\t\tvar args = Array.prototype.slice.call(arguments),\n\t\t\tcallback = args.pop(),\n\t\t\tcommandName = args.shift(),\n\t\t\tparamsArray,\n\t\t\tscript;\n\n\t\tparamsArray = args.map(function(arg) {\n\t\t\tvar param = (typeof arg === 'object') ? JSON.stringify(arg) : arg;\n\n\t\t\tif (typeof param === 'string') {\n\t\t\t\treturn '\"' + param.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"') + '\"';\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn param;\n\t\t\t}\n\t\t});\n\n\t\tscript = commandName + '(' + paramsArray.join(',') + ')';\n\n\t\t// call CEP ExtendScript processor\n\t\tif ( window.__adobe_cep__ ) {\n\t\t\twindow.__adobe_cep__.evalScript( script, callback );\n\t\t}\n\t\telse {\n\t\t\tcallback( null );\n\t\t}\n\t},\n\n\t/**\n\t * Send an event back to the hosting application.\n\t *\n\t * @param eventType         type of event, @see this.events\n\t * @param eventData         data to be sent along with the event\n\t * @param optExtensionID\toptional extension override ID\n\t */\n\tsendEvent: function(eventType, eventData, optExtensionID) {\n\n\t\tif ( window.__adobe_cep__ ) {\n\t\t\tvar event = new CSEvent();\n\n\t\t\tevent.scope         = 'APPLICATION';\n\t\t\tevent.appId         = this.applicationID;\n\t\t\tevent.extensionId   = optExtensionID || iaw.cepUtil.getExtensionID();\n\t\t\tevent.type          = eventType;\n\t\t\tevent.data          = eventData;\n\n\t\t\tthis.csInterface.dispatchEvent(event);\n\t\t}\n\t},\n\n\t/**\n\t * Retrieves the Hello CEP extension's ID from the manifest XML.\n\t *\n\t * @return A string containing the ID from the manifest.\n\t */\n\tgetExtensionID: function() {\n\n\t\treturn ( window.__adobe_cep__ && this.csInterface ) ? this.csInterface.getExtensionID() : '';\n\t},\n\n\t/**\n\t * Retrieves the Hello CEP extension's version from the manifest XML.\n\t *\n\t * @param useBundeledVersion    boolean to indicate which of two possible\n\t *                                  version numbers to use\n\t * @return A string containing the version from the manifest.\n\t */\n\tgetExtensionVersion: function( useBundleVersion ) {\n\n\t\tvar verInfo = { version : '0.0.0', sha : null };\n\n\t\tif ( window.__adobe_cep__ ) {\n\t\t\tvar csInterface     = this.csInterface;\n\t\t\tvar extensionDir    = csInterface.getSystemPath(SystemPath.EXTENSION);\n\n\t\t\t// since we are reading from a local file, it is OS specific so we\n\t\t\t// will need the proper path separator\n\t\t\tvar os              = csInterface.getOSInformation();\n\t\t\tvar pathSeparator   = os.indexOf('Win') >= 0 ? '\\\\' : '/';\n\t\t\tvar manifestPath    = extensionDir + pathSeparator + 'CSXS' + pathSeparator + 'manifest.xml';\n\t\t\tvar fileContents    = window.cep.fs.readFile( manifestPath );\n\n\t\t\tif ( window.DOMParser ) {\n\t\t\t\tvar parser              = new window.DOMParser();\n\t\t\t\tvar xmlDoc              = parser.parseFromString( fileContents.data, 'text/xml' );\n\t\t\t\tvar extManifestElement  = xmlDoc.getElementsByTagName( 'ExtensionManifest' )[0];\n\n\t\t\t\tif ( typeof extManifestElement !== 'undefined' && extManifestElement ) {\n\t\t\t\t\tverInfo.sha = extManifestElement.attributes.getNamedItem('SHA').nodeValue;\n\t\t\t\t\tverInfo.version = ( !useBundleVersion ) ?\n\t\t\t\t\t\textManifestElement.getElementsByTagName( 'ExtensionList' )[0].firstElementChild.attributes.getNamedItem('Version').nodeValue :\n\t\t\t\t\t\textManifestElement.attributes.getNamedItem('ExtensionBundleVersion').nodeValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn verInfo;\n\t},\n\n\t/**\n\t * Async check if user signed in or not.\n\t * @param callback      callback method which takes the following parameters:\n\t *                          a boolean value to indicate user signed in or not\n\t *                          if true, the logged in Adobe GUID is passed in the\n\t *                          second parameter, if false, the second parameter\n\t *                          will be null\n\t */\n\tisUserSignedIn: function(callback) {\n\n\t\tvar imsInterface = this.imsInfo.imsInterface;\n\n\t\tif ( imsInterface ) {\n\t\t\timsInterface.imsGetCurrentUserIdHelper( function(adobeGUID) {\n\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tif (adobeGUID && adobeGUID.length > 0) {\n\t\t\t\t\t\tcallback( true, adobeGUID );\n\t\t\t\t\t}\n\t\t\t\t\telse { callback( false, null ); }\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t/**\n\t * Initialize IMS to either the stage or production (default) servers.\n\t *\n\t * @param mode          either 'stage' or 'prod'\n\t */\n\tsetEnvironment: function( mode ) {\n\n\t\tif ( this.imsInfo.imsInterface ) {\n\t\t\tthis.imsInfo.setEnvironment( mode );\n\t\t}\n\t},\n\n\t/**\n\t * Determine if we are using the stage IMS servers or the production.\n\t *\n\t * @return true if on the IMS stage authentication, false otherwise.\n\t */\n\tusingStageAuthentication: function() {\n\t\tif ( this.isStage === null ) {\n\t\t\tthis.isStage = this.imsInfo.isStagingRedirectInEffect();\n\t\t}\n\t\treturn this.isStage;\n\t},\n\n\t/**\n\t * Get the IMS authentication token for the current user. This is\n\t * an asynchronous call so requires a completion callback which\n\t * gets called when the process has been completed.\n\t *\n\t * @param callback          completion callback\n\t */\n\tgetIMSAccessToken: function( callback ) {\n\n\t\tif ( this.imsInfo.imsInterface ) {\n\t\t\tthis.imsInfo.getAccessToken( callback );\n\t\t}\n\t},\n\n\tgetPrimaryAccountType: function() {\n\t\t\n\t\tvar accountType = '';\n\t\tvar accounts = '';\n\n\t\ttry {\n\t\t\tif (this.imsInfo.imsInterface) {\n\t\t\t\taccounts = this.imsInfo.getIMSAccounts();\n\t\t\t}\n\t\t\tvar xmlDoc = new DOMParser().parseFromString(accounts, 'text/xml');\n\t\t\tvar accType\t= xmlDoc.getElementsByTagName('UserAccounts')[0].getElementsByTagName('UserData')[0].getElementsByTagName('AccountType')[0];\n\t\t\tif (accType) {\n\t\t\t\taccountType = accType.firstChild.nodeValue;\n\t\t\t}\n\t\t}\n\t\tcatch (e) {\n\t\t\tiaw.log.console('Exception in fetching account type');\n\t\t\tiaw.log.exception('Fetch account type exception: ' + e.message);\n\t\t}\n\t\treturn accountType;\n\t},\n\t\n\t/**\n\t * Clear access token.\n\t */\n\tclearAccessToken: function() {\n\t\tif ( this.imsInfo.imsInterface ) {\n\t\t\tthis.imsInfo.clearAccessToken();\n\t\t}\n\t},\n\n\t/**\n\t * Get the current UI theme color.\n\t *\n\t * @return A color object containing the current UI color setting.\n\t */\n\tgetUIThemeColor: function() {\n\n\t\treturn ( this.csInterface ) ? this.csInterface.getHostEnvironment().appSkinInfo.panelBackgroundColor.color : null;\n\t},\n\n\t/**\n\t * Attaches the theme change listener to detect the theme changes from\n\t * the host application.\n\t */\n\taddThemeChangeListener: function() {\n\n\t\tif ( this.csInterface ) {\n\t\t\tthis.csInterface.addEventListener( 'com.adobe.csxs.events.ThemeColorChanged', (function( event ) {\n\t\t\t\tiaw.util.setUIThemeMode();\n\t\t\t}).bind(this));\n\t\t}\n\t},\n\n\t/**\n\t * Create a authenticated jump URL based on client specification.\n\t *\n\t * @param clientID      SSO client ID\n\t * @param clientScope   SSO client scope\n\t * @param url           base url\n\t * @param callback      callback method which takes the following parameters:\n\t *                          the jump url to deal with\n\t */\n\tcreateJumpURL: function(clientID, clientScope, url, callback) {\n\t\tif ( this.imsValid ) {\n\t\t\tthis.imsInfo.jumpURL(clientID, clientScope, url, callback);\n\t\t}\n\t},\n\n\t/**\n\t * Return the path to the extensions root folder.\n\t *\n\t * @return A string containing the extensions root path or null if CEP is not being used.\n\t */\n\tgetExtensionPath: function() {\n\n\t\tvar path = null;\n\n\t\tif ( this.csInterface ) {\n\t\t\tvar os              = this.csInterface.getOSInformation();\n\t\t\tvar pathSeparator   = os.indexOf('Win') >= 0 ? '\\\\' : '/';\n\n\t\t\tpath = this.csInterface.getSystemPath(SystemPath.EXTENSION)+pathSeparator;\n\t\t}\n\t\treturn path;\n\t}\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2016 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n// start loading in all the scripts\ntophat.path('./js/');\n\n// load head and iaw to start things off\ntophat(['fnft-head.js', 'fnft-iaw.js'], function() {\n\t// @ifdef DEBUG\n\tconsole.log('[bootstrap] baobab, iaw loaded in', (window.performance.now() - window.loadTime), 'ms');\n\t// @endif\n\tvar hostData = null;\n\n\t// create data store and attach listeners to it so we know when the data is ready to use\n\tiaw.store = new Baobab({}, {\n\t\timmutable:  false,\n\t\tpersistent: false\n\t});\n\n\tiaw.perf.logToHighBeam = true;\n\n\t// @ifdef DEBUG\n\tiaw.perf.set(iaw.perf.timers.DataTime);\n\tiaw.perf.set(iaw.perf.timers.HostData);\n\t// @endif\n\n\t// get the host app personalization data immediately\n\tif (window.__adobe_cep__) {\n\t\tvar hostID = iaw.cepUtil.applicationID;\n\t\tvar hostIDlc = hostID.toLowerCase();\n\t\tvar loadAppScript = false;\n\n\t\t// disable right click menu\n\t\tdocument.oncontextmenu = function() { return false; };\n\t\t// set the title for the debugger so we know what we are using\n\t\tdocument.title = iaw.cepUtil.getExtensionID();\n\t\t// add theme change event listener\n\t\tiaw.cepUtil.addThemeChangeListener();\n\n\t\t// immediately set the theme so there's no flashing colors\n\t\tvar interfaceColor = iaw.cepUtil.csInterface ? iaw.cepUtil.getUIThemeColor() : null;\n\t\tif (interfaceColor && interfaceColor.red >= 184) {\n\t\t\tdocument.body.classList.remove('spc--dark');\n\t\t}\n\n\t\tswitch (hostIDlc) {\n\t\t\tcase 'phxs':\n\t\t\t\tloadAppScript = true;\n\t\t\t\tbreak;\n\t\t}\n\t\tiaw.log.console('CEP extension for '+hostID+' initializing - acquiring host data...');\n\t\t// Preload cc library as early as possible, as it's asynchronous call and it costs time, which is compose of two parts:\n\t\t//   1. load library api file 200ms\n\t\t//   2. Init and connect to library 400~600ms).\n\t\t// The idea is to make it be parallel for library loading and host/stock data retrieving.\n\t\t// In this way, it can speed up the subsequent loading for getting licensed templates, save up to 200~300ms.\n\t\tiaw.util.loadLibrary(iaw.libraryManager.TEMPLATE_ELEMENT_TYPE);\n\n\t\t// this host needs special help with parsing data\n\t\tif (loadAppScript) {\n\t\t\ttophat('app-'+hostIDlc+'.js', function() {\n\t\t\t\tiaw.apps[hostIDlc].init(boot.receivedHostData, 'fnft');\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\t// this host loads the old way, so we call into XS from here\n\t\t\tiaw.cepUtil.evalExtendScript('CCXWelcomeXSHost_'+hostID+'.getUserJSONData(\"fnft\")', function(jsData) {\n\t\t\t\tif (!jsData) return;\n\n\t\t\t\ttry {\n\t\t\t\t\thostData = JSON.parse(jsData, iaw.json.fnftDataReceiver);\n\t\t\t\t}\n\t\t\t\tcatch (err) {\n\t\t\t\t\tiaw.log.exception('Host JSON parse error: ' + err.message);\n\t\t\t\t}\n\t\t\t\t// check if our parse went ok\n\t\t\t\tboot.receivedHostData(hostData);\n\t\t\t});\n\t\t}\n\t}\n\telse {\n\t\tboot.initHost(iaw.fnftFakeHostData);\n\t\tboot.initPresets(iaw.fnftPresetData);\n\t\tboot.initTemplates(iaw.fnftFakeStockData, iaw.fnftFakeLicensedTemplates);\n\t}\n\n\t// @ifdef DEBUG\n\tiaw.perf.set(iaw.perf.timers.UI);\n\t// @endif\n\n\t// now that the initial logic is done, start loading in the ui\n\ttophat(['fnft-uilib.js', 'spectre-ui.min.js'], function() {\n\t\t// console.log('----- ui lib ready');\n\t\t// riot now exists, so bring in the components\n\t\ttophat('fnft-ui.js', function() {\n\t\t\t// console.log('----- components ready');\n\t\t\triot.mount('container-templates');\n\n\t\t\t// @ifdef DEBUG\n\t\t\tiaw.perf.measure(iaw.perf.timers.UI);\n\t\t\t// @endif\n\t\t});\n\t});\n});\n\n/*\n\tCallbacks\n*/\nwindow.boot = {\n\t/**\n\t *\tCallback for host data event in CEP only\n\t */\n\treceivedHostData: function(hostData) {\n\t\tif (hostData) {\n\t\t\thostData.radarVersion = iaw.cepUtil.getExtensionVersion(true).version;\n\t\t\thostData.radarSessionGUID = iaw.util.generateGUID();\n\n\t\t\t// @ifdef DEBUG\n\t\t\tiaw.perf.measure(iaw.perf.timers.HostData);\n\t\t\t// @endif\n\n\t\t\tboot.initHost(hostData);\n\t\t}\n\t},\n\n\t/**\n\t * After host data is loaded, initialize the app\n\t */\n\tinitHost: function(hostData) {\n\t\tif (!hostData) return;\n\n\t\t// configure authentication servers\n\t\thostData.ingestServer = 'prod';\n\n\t\tif (!iaw.cepUtil.usingStageAuthentication()) {\n\t\t\tiaw.log.console('Authentication environment to production');\n\t\t}\n\t\telse {\n\t\t\tiaw.cepUtil.setEnvironment('stage');\n\t\t\thostData.ingestServer = 'stage';\n\t\t\tiaw.log.console('Authentication environment to stage');\n\t\t}\n\n\t\t// @ifdef DEBUG\n\t\tiaw.perf.set(iaw.perf.timers.InitHost);\n\t\t// @endif\n\n\t\t// add filters & template data from host\n\t\thostData.filters = iaw.fnft.generateFilters(hostData.hostID);\n\t\tiaw.localstorage.userID = hostData.adobeGUID;\n\n\t\t// display count\n\t\thostData.displayCount = parseInt(iaw.localstorage.getUserItem('fnft.displayCount') || 0) + 1;\n\t\tiaw.localstorage.setUserItem('fnft.displayCount', hostData.displayCount);\n\n\t\tiaw.store.set('host', hostData);\n\n\t\t// delete hostData.templates;\n\n\t\t// log the finalize data\n\t\tif (window.__adobe_cep__) {\n\t\t\tiaw.log.logJSON('host.data: ', hostData);\n\t\t}\n\n\t\t// setup translation tables\n\t\tvar lang = hostData.language;\n\n\t\tiaw.i18n.addFromLocalLocaleFile(lang, function(evt) {\n\t\t\triotctrl.trigger('update-i18n-retro');\n\t\t});\n\n\t\t// fill UI with the host data\n\t\triotctrl.trigger('update-host-retro');\n\t\t// start our resize/RWD/DOM update tool\n\t\tiaw.motor.start();\n\t\tiaw.startup.run(iaw.startup.PHASES.Doc); // fnft doesn't have a doc load event, so this is good enough\n\t\tiaw.startup.run(iaw.startup.PHASES.Host);\n\n\t\t// @ifdef DEBUG\n\t\tiaw.perf.measure(iaw.perf.timers.InitHost);\n\t\tiaw.perf.set(iaw.perf.timers.StockData);\n\t\t// @endif\n\n\t\tif (hostData.platform === 'mac') {\n\t\t\t// mac gets special treatment to allow \"cmd+period\" to close the dialog\n\t\t\tvar comboCmd = false;\n\t\t\tvar comboPer = false;\n\t\t\tdocument.addEventListener('keydown', function(evt) {\n\t\t\t\tif (evt.which === 91) comboCmd = true;\n\t\t\t\tif (evt.which === 190) comboPer = true;\n\t\t\t\tif (comboCmd && comboPer) {\n\t\t\t\t\twindow.__adobe_cep__.closeExtension();\n\t\t\t\t}\n\t\t\t}, false);\n\t\t\tdocument.addEventListener('keyup', function(evt) {\n\t\t\t\tif (evt.which === 91) comboCmd = false;\n\t\t\t\tif (evt.which === 190) comboPer = false;\n\t\t\t}, false);\n\t\t}\n\n\t\tif (!window.__adobe_cep__) return;\n\n\t\t// add host close listener\n\t\tiaw.cepUtil.csInterface.addEventListener(iaw.cepUtil.events.HOSTCLOSEFNFT, function() {\n\t\t\twindow.__adobe_cep__.closeExtension();\n\t\t});\n\n\t\t// get the preset data from host\n\t\tiaw.log.console('CEP extension for '+hostData.hostID+' initializing - acquiring preset data...');\n\n\t\t// @ifdef DEBUG\n\t\tiaw.perf.set(iaw.perf.timers.HostPresetData);\n\t\t// @endif\n\n\t\tvar hostIDlc = hostData.hostID.toLowerCase();\n\n\t\tif (iaw.apps && iaw.apps[hostIDlc]) {\n\t\t\tiaw.apps[hostIDlc].initPresets(window.boot.initPresets, 'fnft');\n\t\t}\n\t\telse {\n\t\t\tboot.initPresets(hostData.templates);\n\t\t}\n\t},\n\n\t// presets have been loaded\n\tinitPresets: function(presetData) {\n\t\tvar presetLUT = {};\n\n\t\tvar hostId = iaw.store.get(['host', 'hostID']);\n\t\tfor (var i = 0; i < presetData.length; i++) {\n\t\t\tvar uuid = iaw.util.generateGUID();\n\n\t\t\tpresetData[i].uuid = uuid;\n\t\t\t// Workaround to convert preset's lastUsedTime of AI to local time\n\t\t\tif (hostId === 'ILST' && presetData[i].lastUsedTime) {\n\t\t\t\tpresetData[i].lastUsedTime += (new Date().getTimezoneOffset() * 60000);\n\t\t\t}\n\t\t\tpresetLUT[uuid] = i;\n\t\t}\n\n\t\tiaw.store.set('presets', presetData);\n\t\tiaw.store.set('presetLUT', presetLUT);\n\n\t\tif (window.__adobe_cep__) {\n\t\t\tiaw.log.logJSON('presets.data', presetData);\n\t\t\tiaw.log.logJSON('presets.lut', presetLUT);\n\t\t}\n\n\t\t// fire host data again so we fill the grid with presets\n\t\triotctrl.trigger('update-host-retro');\n\n\t\t// @ifdef DEBUG\n\t\tiaw.perf.measure(iaw.perf.timers.HostPresetData);\n\t\tiaw.perf.measure(iaw.perf.timers.InteractiveTime, window.loadTime);\n\t\t// @endif\n\n\t\tif (!window.__adobe_cep__) return;\n\t\t// use a setTimeout to give the main thread time to parse and render host data\n\t\tsetTimeout(boot.getTemplates, 10);\n\t},\n\n\t// initialize data fetch\n\tgetTemplates: function() {\n\t\tvar hostData = iaw.store.get('host');\n\n\t\tiaw.fnft.getStockData(hostData, function(stockData) {\n\t\t\tvar sd = stockData || iaw.fnft.generateDefaultStockData(hostData);\n\n\t\t\tiaw.log.logJSON('stock.data: ', sd);\n\t\t\t// @ifdef DEBUG\n\t\t\tiaw.perf.measure(iaw.perf.timers.StockData);\n\t\t\tiaw.perf.set(iaw.perf.timers.LicensedData);\n\t\t\t// @endif\n\n\t\t\tiaw.libraryManager.getLicensedTemplates(hostData.hostID)\n\t\t\t\t.then(function(licensedTemplates) {\n\t\t\t\t\t// @ifdef DEBUG\n\t\t\t\t\tiaw.perf.measure(iaw.perf.timers.LicensedData);\n\t\t\t\t\tiaw.perf.measure(iaw.perf.timers.DataTime);\n\t\t\t\t\t// @endif\n\t\t\t\t\tboot.initTemplates(sd, licensedTemplates);\n\t\t\t\t})\n\t\t\t\t.catch(function(err) {\n\t\t\t\t\tiaw.log.logJSON('get licensed templates error: ',  err);\n\t\t\t\t\tboot.initTemplates(sd, []);\n\t\t\t\t});\n\t\t});\n\t},\n\n\t// populate the UI with the templates after it's been loaded\n\tinitTemplates: function(stockData, licensedTemplates) {\n\t\tiaw.perf.set(iaw.perf.timers.TemplateFixup);\n\t\t// move all the licensed templates into the recent tab and update the\n\t\t// last used time so they sort correctly with the presets\n\t\tvar licensedTemplatesLUT = {};\n\t\tvar templateCount = licensedTemplates.length;\n\t\tvar tIndex = 0;\n\n\t\t// TODO: we should initializing an empty array only, after we split out the presets\n\t\tvar templates = iaw.store.clone(['host', 'templates']) || [];\n\t\tlicensedTemplates = licensedTemplates || [];\n\n\t\tfor (tIndex; tIndex < templateCount; ++tIndex) {\n\t\t\tlicensedTemplatesLUT[licensedTemplates[tIndex].id] = tIndex;\n\t\t\t// licensedTemplates[tIndex].template_category = [\"recent\"]; // eslint-disable-line camelcase\n\t\t\t// licensedTemplates[tIndex].lastUsedTime = licensedTemplates[tIndex].modified;\n\t\t}\n\n\t\tif (window.__adobe_cep__) {\n\t\t\tiaw.log.logJSON('licensed.data: ', licensedTemplates);\n\t\t}\n\n\t\t// lastUsedTime priority: host > local cache > cc library\n\t\tvar presets = iaw.store.get('presets');\n\t\tif (presets) {\n\t\t\tpresets.forEach(function(preset) {\n\t\t\t\tif (preset && (!preset.isPreset)) {\n\t\t\t\t\tvar id = iaw.libraryManager.getIdByElementRef(preset.elementRef);\n\t\t\t\t\tiaw.localstorage.setUserItem('templateLUT_' + id, preset.lastUsedTime);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// merge in stock data\n\t\tif (stockData && stockData.templates) {\n\t\t\ttemplateCount = stockData.templates.length;\n\t\t\tfor (tIndex = 0; tIndex < templateCount; ++tIndex) {\n\t\t\t\tvar stockTemplate = stockData.templates[tIndex];\n\t\t\t\tvar licensedDataIndex = licensedTemplatesLUT[stockTemplate.id];\n\n\t\t\t\tif (licensedDataIndex !== undefined) {\n\t\t\t\t\tvar licensedData = licensedTemplates[licensedDataIndex];\n\n\t\t\t\t\tstockTemplate.url = licensedData.url;\n\t\t\t\t\tstockTemplate.elementRef = licensedData.elementRef;\n\t\t\t\t\tstockTemplate.lastUsedTime = iaw.localstorage.getUserItem('templateLUT_' + stockTemplate.id) || licensedData.modified;\n\t\t\t\t\tstockTemplate.licensedTime = licensedData.modified;\n\t\t\t\t\tstockTemplate.thumbnail_url = licensedData.thumbnail_url; // eslint-disable-line camelcase\n\t\t\t\t\tstockTemplate.template_category.push('recent');\t// eslint-disable-line camelcase\n\t\t\t\t\tstockTemplate.template_category.push('saved'); // eslint-disable-line camelcase\n\t\t\t\t}\n\t\t\t\t// make sure all templates have a lastUsedTime parameter defined\n\t\t\t\tif (stockTemplate.lastUsedTime === undefined) {\n\t\t\t\t\tstockTemplate.lastUsedTime = 0;\n\t\t\t\t}\n\t\t\t\t// make sure all templates have a licensedTime parameter defined\n\t\t\t\tif (stockTemplate.licensedTime === undefined) {\n\t\t\t\t\tstockTemplate.licensedTime = 0;\n\t\t\t\t}\n\t\t\t\ttemplates.push(stockTemplate);\n\t\t\t}\n\t\t}\n\n\t\t// merge the licensed templates to the master list\n\t\tvar templateIds = {};\n\t\ttemplates = templates.concat(licensedTemplates);\n\t\ttemplates = templates.filter(function(template, pos) {\n\t\t\tif (!templateIds[template.id]) {\n\t\t\t\ttemplateIds[template.id] = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t    \treturn false;\n\t\t});\n\n\t\t// sort based on timestamp\n\t\t/*templates.sort(function (a, b) {\n\t\t\tif (a.lastUsedTime > b.lastUsedTime) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (a.lastUsedTime < b.lastUsedTime) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\treturn 0;\n\t\t});*/\n\n\t\t// add UUID's to all templates & presets, and build quick reference lookup table\n\t\tvar templateLUT = {};\n\t\ttemplateCount = templates.length;\n\n\t\tfor (tIndex = 0; tIndex < templateCount; ++tIndex) {\n\t\t\tvar uuid = iaw.util.generateGUID();\n\n\t\t\ttemplates[tIndex].uuid = uuid;\n\t\t\ttemplateLUT[uuid] = tIndex;\n\t\t}\n\n\t\tiaw.store.set('templates', templates);\n\t\tiaw.store.set('templateLUT', templateLUT);\n\n\t\tiaw.startup.run(iaw.startup.PHASES.Done);\n\n\t\t// make sure the active item still retains keyboard focus\n\t\tvar activeItem = document.querySelector('.preset-grid-item--active');\n\t\tif (!activeItem) {\n\t\t\t// maybe a template is active, not a preset\n\t\t\tactiveItem = document.querySelector('.template-grid-item--active');\n\t\t}\n\t\tif (activeItem) {\n\t\t\tactiveItem.focus();\n\t\t}\n\n\t\tif (window.__adobe_cep__) {\n\t\t\tiaw.log.logJSON('templates.data', templates);\n\t\t\tiaw.log.logJSON('templates.lut', templateLUT);\n\t\t}\n\t\tiaw.perf.measure(iaw.perf.timers.TemplateFixup);\n\n\t\t// last scripts that we need which aren't used until the user interacts with something\n\t\tiaw.perf.set(iaw.perf.timers.JSLibLateLoad);\n\t\tiaw.util.loadExternalScript('js/marked.min.js')\n\t\t\t.then(function(scriptTag) {\n\t\t\t\t// notify app\n\t\t\t\triotctrl.trigger('markdown-ready-retro');\n\t\t\t});\n\n\t\tiaw.util.loadExternalScript('js/fnft-lib.js')\n\t\t\t.then(function(scriptTag) {\n\t\t\t\t// configure Ingest\n\t\t\t\tif (typeof Ingest !== 'undefined') {\n\t\t\t\t\tvar hostData = iaw.store.get('host');\n\n\t\t\t\t\tiaw.perf.measure(iaw.perf.timers.JSLibLateLoad);\n\t\t\t\t\tiaw.analytics.config('CCXInAppWelcome', hostData, null, hostData.ingestServer);\n\t\t\t\t}\n\t\t\t});\n\n\t\t// @ifdef DEBUG\n\t\tiaw.perf.measure(iaw.perf.timers.LoadTime, window.loadTime);\n\t\t// let the host know we are finished for the most part\n\t\tiaw.cepUtil.sendEvent(iaw.cepUtil.events.INTERACTIVEREADY, null);\n\t\t// @endif\n\t}\n};\n\n/**\n * Add event listeners for drag/drop for the dashboard/panel.\n */\nwindow.addEventListener('dragover', function(e) {\n\te = e || event;\n\t// prevent default to allow drop\n\te.preventDefault();\n}, false);\n\nwindow.addEventListener('drop', function(e) {\n\te = e || event;\n\te.preventDefault();\n}, false);\n\nwindow.addEventListener('dragstart', function(e) {\n\te = e || event;\n\t// Prevent browser-default drag behavior\n\te.preventDefault();\n}, true);\n\nwindow.addEventListener('hashchange', function(e) {\n\te = e || event;\n\te.preventDefault();\n\n\tvar h = iaw.util.parseQueryString(location.hash);\n\triotctrl.trigger('hashchange', h);\n}, false);\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\nwindow.riotctrl = {\n\tevents: {},\n\t// events that have already been fired\n\tburnt: {},\n\t// if listener wants to know if it's already been fired, name the event with this string in it\n\tRETROACTIVE: '-retro',\n\n\ton: function(name, callback, ctx) {\n\t\t(this.events[name] || (this.events[name] = [])).push({\n\t\t\tfn: callback,\n\t\t\tctx: ctx\n\t\t});\n\n\t\tif (!!this.burnt[name] && name.indexOf(this.RETROACTIVE) !== -1) {\n\t\t\t// it already happened and this event is retro-active, so fire immediately with any data that was sent with it then\n\t\t\tcallback.apply(ctx, this.burnt[name]);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tonce: function(name, callback, ctx) {\n\t\tvar self = this;\n\t\t// disable esLint for the following line\n\t\t// since its calls back into itself and we dont want to change the scope\n\t\tvar fn = function() { //eslint-disable-line func-style\n\t\t\tself.off(name, fn);\n\t\t\tcallback.apply(ctx, arguments);\n\t\t};\n\n\t\treturn this.on(name, fn, ctx);\n\t},\n\n\ttrigger: function(name) {\n\t\tvar data = [].slice.call(arguments, 1); // convert args to array\n\t\tvar evtArr = (this.events[name] || []).slice(); // clone arr (probably not necessary, but safe)\n\t\tvar i = 0;\n\t\tvar evt = null;\n\n\t\tfor (i; evt = evtArr[i]; i++) {  //eslint-disable-line no-cond-assign\n\t\t\tevt.fn.apply(evt.ctx, data);\n\t\t}\n\n\t\tif (name.indexOf(this.RETROACTIVE) !== -1) {\n\t\t\t// record emission for future listeners\n\t\t\tthis.burnt[name] = data;\n\t\t}\n\n\t\treturn this;\n\t},\n\n\toff: function(name, callback) {\n\t\tvar evts = this.events[name];\n\t\tvar liveEvents = [];\n\n\t\tif (evts && callback) {\n\t\t\tfor (var i = 0, len = evts.length; i < len; i++) {\n\t\t\t\tif (evts[i].fn !== callback) liveEvents.push(evts[i]);\n\t\t\t}\n\t\t}\n\n\t\t// remove event from queue to prevent memory leak\n\t\tif (liveEvents.length) {\n\t\t\tthis.events[name] = liveEvents;\n\t\t}\n\t\telse {\n\t\t\tdelete this.events[name];\n\t\t}\n\n\t\treturn this;\n\t}\n};\n"],"sourceRoot":"/source/"}