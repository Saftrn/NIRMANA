/**
 * ADOBE CONFIDENTIAL
 *  _________________
 *  Copyright 2016 Adobe Systems Incorporated
 *  All Rights Reserved.
 *
 * NOTICE:  All information contained herein is, and remains
 * the property of Adobe Systems Incorporated and its suppliers,
 * if any.  The intellectual and technical concepts contained
 * herein are proprietary to Adobe Systems Incorporated and its
 * suppliers and are protected by all applicable intellectual property
 * laws, including trade secret and copyright laws.
 * Dissemination of this information or reproduction of this material
 * is strictly forbidden unless prior written permission is obtained
 * from Adobe Systems Incorporated.
 */
"use strict";riot.tag2("debug-menu",'<button if="{showMenu}" class="menu-panel--toggle" onclick="{toggleMenu}" onkeydown="{buttonKeyDown}" onmouseleave="{menuOut}" onmouseenter="{menuOver}" aria-haspopup="true" aria-expanded="{open}" aria-controls="menu-panel-{_riot_id}" title="{toggleLabel}" aria-label="{toggleLabel}"><i class="spc-icons">T</i></button><div hidden class="menu-panel" onmouseleave="{menuOut}" onmouseenter="{menuOver}" role="dialog" aria-hidden="true" id="menu-panel-{_riot_id}"><div role="heading" aria-level="2">DEBUG MENU :: TESTING ONLY</div><div class="menu-panel--item">{version} - {displayMode}</div><div class="menu-panel--spacer"></div><div class="menu-panel--row"><span>Light</span><label class="menu-panel--item spc-switch spc-js-switch" for="switch-1"><input type="checkbox" id="switch-1" class="spc-switch__input" checked onclick="{swapTheme}"></label><span>Dark</span></div><div class="menu-panel--spacer"></div><div class="menu-panel--row"><span>Trial</span><label class="menu-panel--item spc-switch spc-js-switch" for="switch-2"><input type="checkbox" id="switch-2" class="spc-switch__input" onclick="{swapStatus}"></label><span>Paid</span></div><div class="menu-panel--spacer"></div><select aria-label="Language" onchange="{selectLang}"><option value="en_US">English US (en_US)</option><option value="cs_CZ">Czech (cs_CZ)</option><option value="da_DK">Danish (da_DK)</option><option value="de_DE">German (de_DE)</option><option value="en_AE">English Arabic (en_AE)</option><option value="en_GB">English UK (en_GB)</option><option value="en_IL">English Hebrew (en_IL)</option><option value="es_ES">Spanish (es_ES)</option><option value="es_MX">Spanish MX (es_MX)</option><option value="fi_FI">Finnish (fi_FI)</option><option value="fr_FR">French (fr_FR)</option><option value="fr_CA">French CA (fr_CA)</option><option value="fr_MA">French MA (fr_MA)</option><option value="hu_HU">Hungarian (hu_HU)</option><option value="it_IT">Italian (it_IT)</option><option value="ja_JP">Japanese (ja_JP)</option><option value="ko_KR">Korean (ko_KR)</option><option value="nb_NO">Nordish (nb_NO)</option><option value="nl_NL">Dutch (nl_NL)</option><option value="pl_PL">Polish (pl_PL)</option><option value="pt_BR">Brazilian (pt_BR)</option><option value="ru_RU">Russian (ru_RU)</option><option value="sv_SE">Swedish (sv_SE)</option><option value="tr_TR">Turkish (tr_TR)</option><option value="uk_UA">Ukranian (uk_UA)</option><option value="zh_CN">Simplified Chinese (zh_CN)</option><option value="zh_TW">Traditional Chinese (zh_TW)</option></select><div class="menu-panel--spacer"></div><button class="spc-button" onclick="{clearStorage}">/ / / Clear localstorage / / /</button></div>',"",'class="grid grid--center"',function(e){var t=this;this.mixin("spcmixin");var i=null,o=null,n=-1,s=iaw.cepUtil.getExtensionVersion();this.version="CCX Start v"+s.version+" ("+s.sha+")",this.displayMode="unset",this.dark=!0,this.open=!1,this.showMenu=!1,this.trapFocus=!1,this.toggleLabel="Debug",this.buttonKeyDown=function(e){var i=e.keyCode;return(i===iaw.a11y.Keys.ENTER||i===iaw.a11y.Keys.SPACE||i===iaw.a11y.Keys.DOWN&&!t.open)&&(t.trapFocus=!0,i===iaw.a11y.Keys.DOWN&&t.toggleMenu()),!0},this.escapeKey=function(e){t.open&&e.keyCode===iaw.a11y.Keys.ESC&&t.closeMenu()},this.mouseDown=function(e){var i=t.root.getElementsByClassName("menu-panel")[0],o=t.root.getElementsByClassName("menu-panel--toggle")[0];t.open&&(o===e.target||o.contains(e.target)?(iaw.a11y.TrapFocus.deactivate(i),t.trapFocus=!1):i===e.target||i.contains(e.target)||t.closeMenu())},this.swapStatus=function(e){var t="paid"===iaw.store.get(["host","accountStatus"])?"trial":"paid";iaw.store.set(["host","accountStatus"],t),o.parentNode.classList.toggle("is-checked",o.checked),e.target===o&&setTimeout(function(){o.focus()},0),riotctrl.trigger("update-cards-retro"),riot.update(),iaw.localstorage.setGlobalItem("debug.accountStatus",t)},this.swapTheme=function(e){t.dark=!t.dark,t.dark?iaw.util.setUIThemeMode("dark"):iaw.util.setUIThemeMode("light"),i.parentNode.classList.toggle("is-checked",i.checked),riotctrl.trigger("update-theme"),e.target===i&&setTimeout(function(){i.focus()},0)},this.selectLang=function(e){var t=e.target.value;iaw.store.set(["host","language"],t),"undefined"!=typeof moment&&moment.locale(t),iaw.i18n.addFromLocalLocaleFile(t,function(){riotctrl.trigger("update-i18n-retro")}),"en_GB"===t&&(t="en_US");var i="paid"===iaw.store.get(["host","accountStatus"])?"":"_trial";"undefined"!=typeof iaw.data&&iaw.data.debugPSDK.getData("cards_"+t+i+".json",function(){riotctrl.trigger("update-cards-retro")})},this.clearStorage=function(){window.localStorage.clear(),t.closeMenu()},this.menuOver=function(e){t.open&&clearTimeout(n)},this.menuOut=function(e){t.open&&!t.trapFocus&&(n=setTimeout(t.closeMenu.bind(t),500))},this.closeMenu=function(){t.toggleMenu(null,!0)},this.toggleMenu=function(e,i){var o=t.root.getElementsByClassName("menu-panel")[0],n=t.root.getElementsByClassName("menu-panel--toggle")[0],s={};i&&(t.open=!0),t.open?(o.setAttribute("aria-hidden","true"),o.classList.remove("anim--open-menu"),o.classList.add("anim--close-menu"),n.setAttribute("aria-expanded","false"),iaw.a11y.TrapFocus.deactivate(o),t.trapFocus=!1,window.removeEventListener("keydown",t.escapeKey),window.removeEventListener("mousedown",t.mouseDown)):(o.removeAttribute("aria-hidden"),o.removeAttribute("hidden"),o.classList.remove("anim--close-menu"),o.classList.add("anim--open-menu"),n.setAttribute("aria-expanded","true"),t.trapFocus||(s.initialFocus=o),setTimeout(function(){iaw.a11y.TrapFocus.activate(o,s)},20),window.addEventListener("keydown",t.escapeKey),window.addEventListener("mousedown",t.mouseDown,!0)),t.open=!t.open},this.on("mount",function(){i=document.getElementById("switch-1"),o=document.getElementById("switch-2"),this.escapeKey=this.escapeKey.bind(this),this.mouseDown=this.mouseDown.bind(this),this.showMenu&&riotctrl.on("update-host-retro",this.closeMenu,this)}),this.closeMenu=function(){var e=iaw.store.get(["host","accountStatus"]),i=iaw.localstorage.getGlobalItem("debug.accountStatus");i!==e&&(e=i,iaw.store.set(["host","accountStatus"],e),o.checked="paid"===e,o.parentNode.classList.toggle("is-checked",o.checked)),t.displayMode=iaw.store.get(["host","displayMode"]),t.update()}}),riot.tag2("dynamic-component","","","",function(e){this.on("mount",function(){riot.mount(this.root,e.data.tag,e)})}),riot.tag2("raw-text","<span></span>","","",function(e){this.on("mount",function(){this.root.innerHTML=e.content})}),riot.tag2("tooltip","<span></span>","",'role="tooltip" id="tooltip-{_riot_id}"',function(e){var t,i=this,o=null,n=null,s=null,a=null,r={x:0,y:0},l=0,c=500;this.updateMouse=function(e){r.x=e.clientX,r.y=e.clientY},this.refresh=function(e){"focus"===e.type?(t=e.target.firstElementChild.getBoundingClientRect(),l||(l=parseInt(getComputedStyle(i.root).getPropertyValue("margin-top"))),i.root.style.left=t.left+.5*t.width+"px",i.root.style.top=t.top+.8*t.height-l+"px",e.target.addEventListener("keydown",i.onKeyDown,!1),t=void 0):(i.root.style.left=r.x+"px",i.root.style.top=r.y+"px"),o.innerText=s,i.root.classList.add("show",a)},this.onOver=function(e){return s=e.target.getAttribute("data-tip"),a=e.target.getAttribute("data-tip-class"),!(!o||!s||""===s)&&(e.target.addEventListener("mousemove",i.updateMouse,!1),c="focus"===e.type?1e3:500,void(n=setTimeout(i.refresh,c,e)))},this.onOut=function(e){e.target.removeEventListener("mousemove",i.updateMouse),e.target.removeEventListener("keydown",i.onKeyDown),i.root.classList.remove("show",a),o.innerText="",clearTimeout(n)},this.onKeyDown=function(e){e.keyCode===iaw.a11y.Keys.ESC&&(i.onOut(e),e.preventDefault(),e.stopImmediatePropagation())},this.rescan=function(){o=i.root.getElementsByTagName("span")[0];for(var e=document.querySelectorAll("[data-tip]"),t=null,n=0;t=e[n];n++)t.hasDataTipListener||(t.setAttribute("aria-describedby",i.root.id),t.addEventListener("focus",i.onOver,!0),t.addEventListener("mouseenter",i.onOver,!1),t.addEventListener("mouseleave",i.onOut,!1),t.addEventListener("mousedown",i.onOut,!1),t.addEventListener("blur",i.onOut,!0),t.hasDataTipListener=!0)},this.delayScan=function(){setTimeout(i.rescan,30)},this.on("mount",function(){this.rescan(),riotctrl.on("update-host-retro",this.delayScan),riotctrl.on("update-cards-retro",this.delayScan),riotctrl.on("update-mru-list",this.delayScan),riotctrl.on("tab-change",this.delayScan),riotctrl.on("file-view-change",this.delayScan),riotctrl.on("mobileAssetsProjectsLoaded",this.delayScan),riotctrl.on("mobileAssetsPagesLoaded",this.delayScan),riotctrl.on("scan-tooltips",this.delayScan)}),this.on("unmount",function(){this.off("*"),riotctrl.off("update-host-retro",this.delayScan),riotctrl.off("update-cards-retro",this.delayScan),riotctrl.off("update-mru-list",this.delayScan),riotctrl.off("tab-change",this.delayScan),riotctrl.off("file-view-change",this.delayScan),riotctrl.off("mobileAssetsProjectsLoaded",this.delayScan),riotctrl.off("mobileAssetsPagesLoaded",this.delayScan),riotctrl.off("scan-tooltips",this.delayScan)})}),riot.tag2("action-footer",'<button class="spc-button" onclick="{onAction}" data-action="host-close-fnft" data-i18n="close"></button><button class="spc-button spc-button--cta" onclick="{onAction}" data-action="host-create-template-doc" data-i18n="create"></button>',"","",function(e){this.mixin("i18n"),this.leaf=null,this.onAction=function(e){var t=e.target.dataset.action,i={settings:{}};switch(iaw.util.assign(i,iaw.fnft.getTemplateData(iaw.store.get(["input","selected-item"]))),iaw.util.assign(i.settings,iaw.store.get(["input","settings"])),t){case"host-close-fnft":iaw.analytics.ingest.logFNFTActionClickedEvent("close",i),iaw.analytics.ingest.flushEvent();break;case"host-create-template-doc":iaw.analytics.ingest.logFNFTActionClickedEvent("preset-create",i),iaw.analytics.ingest.flushEvent()}riotctrl.trigger(t)},this.on("mount before-unmount",function(e){"before-unmount"===e&&this.off("*")})}),riot.tag2("container-templates",'<template-download></template-download><div class="template-nav"><debug-menu></debug-menu><template-tab onkeydown="{keydown}" role="tablist" each="{tabs}" data="{this}"></template-tab><div class="spc-tabs__line"></div></div><div class="gallery-container"><div class="gallery-scroll scroll-container"><div class="scroll-pane"><template-grid></template-grid></div></div><div id="stock-bar"><div class="stock-bar__wrapper"><form onsubmit="{openStockLink}"><i class="inapp-icons inapp-icon--search" aria-hidden="true"></i><div class="spc-textfield spc-js-textfield spc-textfield--quiet"><input class="spc-textfield__input" tabindex="-1" type="text"></div><button class="spc-button spc-button--secondary" tabindex="-1" data-i18n="go"></button></form></div></div><div id="template-preview--small" class="hidden"></div><div id="sidebar-container" class="sidebar-scroll"></div></div><div id="template-preview--large" class="hidden"></div><preview-nav></preview-nav><screen-download></screen-download><tooltip></tooltip>',"","",function(e){var t=this;this.mixin("i18n"),this.mixin("spcmixin"),this.mixin("cooldown"),this.tabs=null;var i=[0,1050],o=[0,0],n=0,s=0,a=-1,r=!1;this.currentBreakpoint=function(){var e,t;for(e=0;e<i.length;e++)t=window.innerWidth-o[e],t>i[e]&&(a=e);a<0&&(a=0)},this.checkBreakpoints=function(){var e=window.innerWidth;(r||e!==n)&&(n=e,t.currentBreakpoint(),(r||a!==s)&&(iaw.util.currentBreakPoint=a,riotctrl.trigger("resize-breakpoint",s,a),s=a),r=!1)},this.keydown=function(e){var i,o=e.keyCode,n=t.root.querySelector(".template-tab--active"),s=t.root.querySelectorAll("template-tab");switch(o){case iaw.a11y.Keys.END:i=s[s.length-1];break;case iaw.a11y.Keys.HOME:i=s[0];break;case iaw.a11y.Keys.LEFT:case iaw.a11y.Keys.UP:i=n.previousSibling;break;case iaw.a11y.Keys.RIGHT:case iaw.a11y.Keys.DOWN:i=n.nextSibling}return i&&(i=i.querySelector("a"),i.click(),i.focus()),!0},this.openStockLink=function(e){if(!t.isCoolingDown(0)){var i=iaw.store.get(["input","active-filter"]),o=iaw.util.openStockLink(iaw.store.get(["host","hostID"]),i,e.target[0].value),n={actionURL:o,activeFilter:i};iaw.analytics.ingest.logFNFTActionClickedEvent("stock-search",n),iaw.analytics.pip.logFNFTDataGroupEvent("Search Stock",{category:i})}},this.on("mount",function(){riotctrl.on("update-host-retro",this.onHost,this),riotctrl.on("show-stock-bar",this.onShowStockBar,this),riotctrl.on("hide-stock-bar",this.onHideStockBar,this),riotctrl.on("update-i18n-retro",this.onI18n,this),riotctrl.on("hashchange",this.onInternalLink,this),this.checkBreakpoints()}),this.on("before-unmount",function(){iaw.motor.remove(this.checkBreakpoints),riotctrl.off("update-host-retro",this.onHost,this),riotctrl.off("show-stock-bar",this.onShowStockBar,this),riotctrl.off("hide-stock-bar",this.onHideStockBar,this),riotctrl.off("update-i18n-retro",this.onI18n,this),riotctrl.off("hashchange",this.onInternalLink,this),this.off("*")}),this.onI18n=function(){var e=document.querySelector("#stock-bar .spc-textfield__input");e&&e.setAttribute("placeholder",iaw.i18n.getLocalizedString("adobe_stock_find_more"))},this.onShowStockBar=function(){var e=document.querySelector(".gallery-scroll");e&&e.removeAttribute("style"),e=document.getElementById("stock-bar"),e&&e.classList.remove("hidden")},this.onHideStockBar=function(){var e=document.querySelector(".gallery-scroll");e&&(e.style.marginBottom="0px"),e=document.getElementById("stock-bar"),e&&e.classList.add("hidden")},this.onHost=function(){t.tabs=iaw.store.get(["host","filters"]),iaw.motor.add(t.checkBreakpoints,t),r=!0,t.update()},this.onInternalLink=function(e){if(e.category){for(var i=t.tabs.slice(),o=0;o<i.length;o++)if("recent"===i[o].type||"saved"===i[o].type){var n=i.indexOf(i[o]);n!==-1&&i.splice(n,1),o=-1}riotctrl.trigger(iaw.fnftEvents.FILTER,i[e.category].type)}}});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};riot.tag2("preset-form-ilst",'<div class="sidebar-padding"><h6 class="spc-typography--caption preset-form__caption">{heading}</h6></div><div name="docsettingsScrollContainer" class="form-preset__container scroll-container"><div class="scroll-pane"><form name="docsettings" class="docsettings__form" onchange="{validateNumericFields}" onkeypress="{formKeypressHandler}" onclick="{formClickHandler}"><div class="docsettings__doc-name spc-textfield spc-js-textfield spc-textfield--quiet document-name"><input name="formName" class="spc-textfield__input" type="text" onchange="{validateName}" onclick="{selectInput}" value="{defaultDocumentName}"></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{widthLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2 docsettings--flex-start"><div class="spc-textfield spc-js-textfield"><input name="formWidth" onclick="{selectInput}" onchange="{updateWidth}" onkeypress="{updateWidth}" onwheel="{incrementSupport()}" onkeydown="{incrementSupport()}" class="spc-textfield__input" pattern="[0-9]*" min="{this.convertedMinDocWidth}" step="{1 / Math.pow(10, roundingRules[currentUnit])}" max="{this.convertedMaxDocWidth}" value="{currentWidth}" type="{\'number\'}"></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{heightLabel}</span></div></div><div class="docsettings__row"><div class="spc-textfield spc-js-textfield docsettings--no-margin"><input name="formHeight" onclick="{selectInput}" onchange="{updateHeight}" onkeypress="{updateHeight}" onwheel="{incrementSupport()}" onkeydown="{incrementSupport()}" class="spc-textfield__input" pattern="[0-9]*" step="{1 / Math.pow(10, roundingRules[currentUnit])}" min="{this.convertedMinDocHeight}" max="{this.convertedMaxDocHeight}" value="{currentHeight}" type="{\'number\'}"></div><div class="docsettings--grow-5"></div></div></div><div class="docsettings--grow-5 docsettings--stretch"><div name="unitDropdown" onchange="{unitDropdownHandler}" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{widthLabel}</em></div><hr class="spc-dropdown__divider"><div class="spc-dropdown__options"><div class="{is-checked: defaultUnits === unit.value, spc-dropdown__option:true}" data-value="{unit.value}" each="{unit in localizedUnits}" if="{unit.value !== \'columnsUnit\'}"> {unit.localizedValue} </div></div></div></div><div class="docsettings__row"><div class="docsettings--grow-1"><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-1"><span class="docsettings__field-label spc-textfield--left-label">{orientationLabel}</span></div></div><div class="docsettings__row docsettings__row--orientation"><div class="docsettings--grow-1 docsettings__orientation-input" name="orientationInput"><label class="spc-icon-toggle spc-js-icon-toggle" for="orientationPortrait"><input id="orientationPortrait" type="checkbox" value="portrait" class="spc-icon-toggle__input" onchange="{orientationChangeHandler}" checked><i class="spc-icon-toggle__label inapp-icons inapp-icon--portrait"></i></label><label class="spc-icon-toggle spc-js-icon-toggle" for="orientationLandscape"><input id="orientationLandscape" type="checkbox" value="landscape" class="spc-icon-toggle__input" onchange="{orientationChangeHandler}"><i class="spc-icon-toggle__label inapp-icons inapp-icon--landscape"></i></label></div></div></div><div class="docsettings--grow-1 docsettings--stretch"><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label--nowrap spc-textfield--left-label">{artboardLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2"><div class="spc-textfield spc-js-textfield spc-textfield__number"><input name="artboardInput" class="spc-textfield__input" pattern="[0-9]*" inputmode="numeric" step="1" alt-step="10" min="{artBoardMin}" max="{artBoardMax}" value="{artboardCount}" type="{\'number\'}"><div class="spc-textfield__stepstack"><div class="spc-textfield__stepup"></div><div class="spc-textfield__stepdown"></div></div></div></div></div></div></div></div></div><div class="docsettings__row"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{bleedLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-4"><div class="docsettings__row"><div class="docsettings--grow-1"><div class="docsettings__field-label spc-textfield--left-label docsettings__row--spacing">{topLabel}</div><div class="spc-textfield spc-js-textfield spc-textfield__number" data-bleed onmousedown="{incrementSupport()}" onchange="{bleedHandler}"><input name="topbleed" class="spc-textfield__input" onchange="{updateTopBleed}" onkeypress="{updateTopBleed}" onclick="{selectInput}" data-bleed onwheel="{incrementSupport()}" onkeydown="{incrementSupport()}" pattern="[0-9]*" inputmode="numeric" alt-step="any" step="any" min="{convertedMinBleed}" max="{convertedMaxBleed}" value="{topBleedValue}" type="{\'number\'}"><div class="spc-textfield__stepstack"><div class="spc-textfield__stepup"></div><div class="spc-textfield__stepdown"></div></div></div></div><div class="docsettings--grow-1"><div class="docsettings__field-label spc-textfield--left-label docsettings__row--spacing">{bottomLabel}</div><div class="spc-textfield spc-js-textfield spc-textfield__number" data-bleed onmousedown="{incrementSupport()}" onchange="{bleedHandler}"><input name="bottombleed" class="spc-textfield__input" onchange="{updateBottomBleed}" onkeypress="{updateBottomBleed}" onclick="{selectInput}" data-bleed onwheel="{incrementSupport()}" onkeydown="{incrementSupport()}" pattern="[0-9]*" inputmode="numeric" alt-step="any" step="any" min="{convertedMinBleed}" max="{convertedMaxBleed}" value="{bottomBleedValue}" type="{\'number\'}"><div class="spc-textfield__stepstack"><div class="spc-textfield__stepup"></div><div class="spc-textfield__stepdown"></div></div></div></div></div><div class="docsettings__row"><div class="docsettings--grow-1"><div class="docsettings__field-label spc-textfield--left-label docsettings__row--spacing">{leftLabel}</div><div class="spc-textfield spc-js-textfield spc-textfield__number" data-bleed onmousedown="{incrementSupport()}" onchange="{bleedHandler}"><input name="leftbleed" class="spc-textfield__input" onchange="{updateLeftBleed}" onkeypress="{updateLeftBleed}" onclick="{selectInput}" data-bleed onwheel="{incrementSupport()}" onkeydown="{incrementSupport()}" pattern="[0-9]*" inputmode="numeric" alt-step="any" step="any" min="{convertedMinBleed}" max="{convertedMaxBleed}" value="{leftBleedValue}" type="{\'number\'}"><div class="spc-textfield__stepstack"><div class="spc-textfield__stepup"></div><div class="spc-textfield__stepdown"></div></div></div></div><div class="docsettings--grow-1"><div class="docsettings__field-label spc-textfield--left-label docsettings__row--spacing">{rightLabel}</div><div class="spc-textfield spc-js-textfield spc-textfield__number" data-bleed onmousedown="{incrementSupport()}" onchange="{bleedHandler}"><input name="rightbleed" class="spc-textfield__input" onchange="{updateRightBleed}" onkeypress="{updateRightBleed}" onclick="{selectInput}" data-bleed onwheel="{incrementSupport()}" onkeydown="{incrementSupport()}" pattern="[0-9]*" inputmode="numeric" alt-step="any" step="any" min="{convertedMinBleed}" max="{convertedMaxBleed}" value="{rightBleedValue}" type="{\'number\'}"><div class="spc-textfield__stepstack"><div class="spc-textfield__stepup"></div><div class="spc-textfield__stepdown"></div></div></div></div></div></div><div class="docsettings--grow-1"><button name bleedchain class="docsettings__bleed-button spc-icons {spc-icon--link:lockBleed, spc-icon--unlink:!lockBleed, docsettings__bleed-button--depressed:lockBleed}" type="button" name="button" onclick="{bleedChainHandler}"></button></div></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{colorModeLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-4"><div name="colorModesInput" onchange="{colorModeChangeHandler}" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{colorModeLabel}</em></div><hr class="spc-dropdown__divider"><div name="unitselection" class="spc-dropdown__options"><div class="{is-checked: defaultColorMode === mode.mode, spc-dropdown__option:true}" data-value="{mode.mode}" each="{mode in localizedColorModes}"> {mode.localizedValue} </div></div></div></div></div><div class="docsettings--grow-1"><i name="colorModeWarningIcon" class="docsettings__warning spc-icons spc-icon--warn" data-tip="{colorModeWarning}" data-tip-class="docsettings__warning__tooltip"></i></div></div></form><button class="docsettings__more-actions-button spc-button spc-button--quiet" onclick="{onAction}" data-action="host-more-options">{customizeLabel}</button></div></div><action-footer></action-footer>',"",'class="preset-form--ilst"',function(e){var t=this;this.mixin("unitConversion"),this.mixin("cooldown"),this.mixin("tooltip"),this.constant={POINTS_PER_PICA:12},this.conversionMappings={pixelsUnit:"px",millimetersUnit:"mm",centimetersUnit:"cm",inchesUnit:"in",picasUnit:"pc",pointsUnit:"pt",qsUnit:"ha"},this.roundingRules={pixelsUnit:0,millimetersUnit:2,centimetersUnit:2,inchesUnit:3,picasUnit:2,pointsUnit:3,qsUnit:2},this.bleedRoundingRules={pixelsUnit:3,millimetersUnit:2,centimetersUnit:2,inchesUnit:4,picasUnit:2,pointsUnit:3,qsUnit:3},this.bleedIncrement={pixelsUnit:1,millimetersUnit:1,centimetersUnit:.1,inchesUnit:.125,picasUnit:1,pointsUnit:1,qsUnit:1},this.secondaryBleedIncrement={pixelsUnit:.1,millimetersUnit:.5,centimetersUnit:.05,inchesUnit:.0625,picasUnit:.1,pointsUnit:.1,qsUnit:.5},this.shiftBleedIncrement={pixelsUnit:10,millimetersUnit:10,centimetersUnit:1,inchesUnit:1,picasUnit:1,pointsUnit:10,qsUnit:4},this.customizeLabel="",this.defaultDocumentName="",this.heading="",this.widthLabel="",this.heightLabel="",this.colorModeLabel="",this.bleedLabel="",this.topLabel="",this.bottomLabel="",this.leftLabel="",this.rightLabel="",this.orientationLabel="",this.artboardLabel="",this.localizedUnits=[],this.localizedColorModes=[],this.colorModeWarning="",this.localizeArray=function(e,t){var i=[];if(Array.isArray(t)){var o,n;for(o=0,n=t.length;o<n;o++)"string"==typeof t[o]?i.push({value:t[o],localizedValue:iaw.i18n.getLocalizedString(e+t[o])}):"object"===_typeof(t[o])&&i.push({values:t[o].values,mode:t[o].mode,localizedValue:iaw.i18n.getLocalizedString(e+t[o].mode)})}return i},this.onAction=function(e){var i=e.target.dataset.action;if("host-more-options"===i){var o=iaw.store.get(["input","settings"]),n={presetAttributes:{attributes:t.initialSettings,newAttributes:o,attributesChanged:t.hasChanged(t.initialSettings,o)}};iaw.util.assign(n,t.data),iaw.analytics.ingest.logFNFTActionClickedEvent("more-options",n)}riotctrl.trigger(i)},this.validateNumericFields=function(){var e=this.currentHeight,t=this.currentWidth,i=Number(this.artboardInput.value);isNaN(i)&&(i=this.artboardCount),t>this.convertedMaxDocWidth&&(t=this.convertedMaxDocWidth),e>this.convertedMaxDocHeight&&(e=this.convertedMaxDocHeight),t<this.convertedMinDocWidth&&(t=this.convertedMinDocWidth),e<this.convertedMinDocHeight&&(e=this.convertedMinDocHeight),this.updateOrientationIcons(t,e),this.formHeight.parentElement.classList.remove("is-invalid"),this.formWidth.parentElement.classList.remove("is-invalid"),this.currentHeight=e,this.currentWidth=t,this.artboardCount=i,this.formHeight.value=iaw.util.roundDecimal(e,this.roundingRules[this.currentUnit]),this.formWidth.value=iaw.util.roundDecimal(t,this.roundingRules[this.currentUnit]),this.validateBleed(),this.setStore()},this.validateBleed=function(){for(var e=[this.topBleedValue,this.bottomBleedValue,this.leftBleedValue,this.rightBleedValue],t=0,i=e.length;t<i;t++)e[t]<this.convertedMinBleed?e[t]=this.convertedMinBleed:e[t]>this.convertedMaxBleed&&(e[t]=this.convertedMaxBleed);this.topBleedValue=e[0],this.bottomBleedValue=e[1],this.leftBleedValue=e[2],this.rightBleedValue=e[3],this.topbleed.value=iaw.util.roundDecimal(e[0],this.bleedRoundingRules[this.currentUnit]),this.bottombleed.value=iaw.util.roundDecimal(e[1],this.bleedRoundingRules[this.currentUnit]),this.leftbleed.value=iaw.util.roundDecimal(e[2],this.bleedRoundingRules[this.currentUnit]),this.rightbleed.value=iaw.util.roundDecimal(e[3],this.bleedRoundingRules[this.currentUnit]),setTimeout(function(){this.topbleed.parentElement.classList.remove("is-invalid"),this.bottombleed.parentElement.classList.remove("is-invalid"),this.leftbleed.parentElement.classList.remove("is-invalid"),this.rightbleed.parentElement.classList.remove("is-invalid")}.bind(this),0)},this.setStore=function(){var e=t.unitDropdown.querySelector(".is-checked"),i=t.colorModesInput.querySelector(".is-checked"),o=t.conversionHelper(t.currentWidth,t.conversionMappings[t.currentUnit],"pt"),n=t.conversionHelper(t.currentHeight,t.conversionMappings[t.currentUnit],"pt"),s=t.conversionHelper(t.topBleedValue,t.conversionMappings[t.currentUnit],"pt"),a=t.conversionHelper(t.bottomBleedValue,t.conversionMappings[t.currentUnit],"pt"),r=t.conversionHelper(t.leftBleedValue,t.conversionMappings[t.currentUnit],"pt"),l=t.conversionHelper(t.rightBleedValue,t.conversionMappings[t.currentUnit],"pt"),c=t.appSpecificKey;c.bleedOffset=[parseFloat(r),parseFloat(s),parseFloat(l),parseFloat(a)],c.lockBleed=t.lockBleed,iaw.store.set(["input","doc-name"],t.formName.value||t.defaultDocumentName);var d=iaw.store.set(["input","settings"],{width:iaw.util.roundDecimal(o,t.roundingRules[t.currentUnit]),height:iaw.util.roundDecimal(n,t.roundingRules[t.currentUnit]),units:e.dataset.value,mode:i.dataset.value,numArtboards:parseInt(t.artboardCount),appSpecificKey:c});t.hasChanged(t.initialSettings,d)?d.name="":d.name=t.data.title},this.updateOrientationIcons=function(e,t){t>=e?(this.check(this.orientationPortrait),this.uncheck(this.orientationLandscape)):t<e&&(this.uncheck(this.orientationPortrait),this.check(this.orientationLandscape))},this.toggleOrientation=function(){var e=this.currentWidth;this.currentWidth=this.currentHeight,this.currentHeight=e},this.check=function(e){e.checked=!0,e.parentElement.classList.add("is-checked")},this.uncheck=function(e){e.checked=!1,e.parentElement.classList.remove("is-checked")},this.hasChanged=function(e,t){var i;for(i in e)if(e.hasOwnProperty(i)&&t.hasOwnProperty(i)){if(void 0===e[i])continue;if(e[i]!==t[i])return!0}return!1},this.closeDropDownsExcept=function(e){var t,i;for(t=0,i=this.dropDownElements.length;t<i;t++)this.dropDownElements[t].contains(e)||this.dropDownElements[t].classList.remove("is-open")},this.convertBounds=function(e){var t=this;this.convertedMaxDocWidth=this.conversionHelper(this.maxDocWidth,"px",e),this.convertedMaxDocHeight=this.conversionHelper(this.maxDocWidth,"px",e),this.convertedMinDocWidth=this.conversionHelper(this.minDocWidth,"px",e),this.convertedMinDocHeight=this.conversionHelper(this.minDocWidth,"px",e),this.convertedMinBleed=this.conversionHelper(this.bleedMin,"px",e),this.convertedMaxBleed=this.conversionHelper(this.bleedMax,"px",e),this.convertedMaxDocWidth=iaw.util.floorDecimal(this.convertedMaxDocWidth,this.roundingRules[this.currentUnit]),this.convertedMaxDocHeight=iaw.util.floorDecimal(this.convertedMaxDocHeight,this.roundingRules[this.currentUnit]),this.convertedMinDocWidth=iaw.util.ceilDecimal(this.convertedMinDocWidth,this.roundingRules[this.currentUnit]),this.convertedMinDocHeight=iaw.util.ceilDecimal(this.convertedMinDocHeight,this.roundingRules[this.currentUnit]),this.convertedMinBleed=iaw.util.ceilDecimal(this.convertedMinBleed,this.bleedRoundingRules[this.currentUnit]),this.convertedMaxBleed=iaw.util.ceilDecimal(this.convertedMaxBleed,this.bleedRoundingRules[this.currentUnit]),setTimeout(function(){t.update(),t.validateNumericFields()},0)},this.conversionHelper=function(e,t,i){var o=this.convert(e,{pointsPerInch:this.pointsPerInch,picasPerInch:this.picasPerInch,precision:10}).from(t).to(i);return o},this.updateAllBleed=function(e){this.topbleed.value=this.topBleedValue=e,this.bottombleed.value=this.bottomBleedValue=e,this.leftbleed.value=this.leftBleedValue=e,this.rightbleed.value=this.rightBleedValue=e,this.setStore()},this.selectInput=function(e){e.target.select()},this.updateHeight=function(e){var t=Number(e.target.value);return isNaN(t)&&(t=this.currentHeight),this.currentHeight=t,!0},this.updateWidth=function(e){var t=Number(e.target.value);return isNaN(t)&&(t=this.currentWidth),this.currentWidth=t,!0},this.updateTopBleed=function(e){var t=Number(e.target.value);return isNaN(t)&&(t=this.topBleedValue),this.topBleedValue=t,!0},this.updateBottomBleed=function(e){var t=Number(e.target.value);return isNaN(t)&&(t=this.bottomBleedValue),this.bottomBleedValue=t,!0},this.updateLeftBleed=function(e){var t=Number(e.target.value);return isNaN(t)&&(t=this.leftBleedValue),this.leftBleedValue=t,!0},this.updateRightBleed=function(e){var t=Number(e.target.value);return isNaN(t)&&(t=this.rightBleedValue),this.rightBleedValue=t,!0},this.validateName=function(e){var t=e.target.value;""===t&&(e.target.value=this.defaultDocumentName)},this.orientationChangeHandler=function(e){return e.target.checked?(t.toggleOrientation(),!0):(t.updateOrientationIcons(),!1)},this.unitDropdownHandler=function(e){t.currentWidth=t.conversionHelper(t.currentWidth,t.conversionMappings[t.currentUnit],t.conversionMappings[e.target.dataset.value]),t.currentHeight=t.conversionHelper(t.currentHeight,t.conversionMappings[t.currentUnit],t.conversionMappings[e.target.dataset.value]),
t.topBleedValue=t.conversionHelper(t.topBleedValue,t.conversionMappings[t.currentUnit],t.conversionMappings[e.target.dataset.value]),t.bottomBleedValue=t.conversionHelper(t.bottomBleedValue,t.conversionMappings[t.currentUnit],t.conversionMappings[e.target.dataset.value]),t.leftBleedValue=t.conversionHelper(t.leftBleedValue,t.conversionMappings[t.currentUnit],t.conversionMappings[e.target.dataset.value]),t.rightBleedValue=t.conversionHelper(t.rightBleedValue,t.conversionMappings[t.currentUnit],t.conversionMappings[e.target.dataset.value]),t.currentUnit=e.target.dataset.value,t.convertBounds(t.conversionMappings[e.target.dataset.value])},this.incrementSupport=function(e){return function(t){if("wheel"!==t.type&&"mousedown"!==t.type||(t.preventDefault(),!this.isCoolingDown(0,40))){var i,o=t.target,n="pixelsUnit"===this.currentUnit?1:.1;if(t.keyCode&&t.keyCode===iaw.a11y.Keys.DOWN||t.wheelDelta&&t.wheelDelta<0||"mousedown"===t.type&&t.target.classList.contains("spc-textfield__stepdown")?i="down":(t.keyCode&&t.keyCode===iaw.a11y.Keys.UP||t.wheelDelta&&t.wheelDelta>0||"mousedown"===t.type&&t.target.classList.contains("spc-textfield__stepup"))&&(i="up"),"mousedown"===t.type&&(o=t.target.parentElement.parentElement.querySelector("input")),o===document.activeElement||"mousedown"===t.type)return e=e||n,t.shiftKey&&(e*=10),void 0!==o.dataset.bleed&&(e=this.bleedIncrement[this.currentUnit],t.metaKey&&!t.shiftKey&&(e=this.secondaryBleedIncrement[this.currentUnit]),t.shiftKey&&!t.metaKey&&(e=this.shiftBleedIncrement[this.currentUnit])),"up"===i?(t.preventDefault(),o.value=iaw.util.roundDecimal(Number(o.value)+e,4),o.dispatchEvent(new Event("change",{bubbles:!0})),o.select()):"down"===i&&(t.preventDefault(),o.value=iaw.util.roundDecimal(Number(o.value)-e,4),o.dispatchEvent(new Event("change",{bubbles:!0})),o.select()),!0}}},this.formKeypressHandler=function(e){return e.keyCode===iaw.a11y.Keys.ENTER&&(e.stopPropagation(),t.validateNumericFields(),riotctrl.trigger("host-create-template-doc")),!0},this.formClickHandler=function(e){return t.closeDropDownsExcept(e.srcElement),!0},this.colorModeChangeHandler=function(e){t.initialSettings.mode!==e.target.dataset.value?t.colorModeWarningIcon.classList.add("docsettings__warning--show"):t.colorModeWarningIcon.classList.remove("docsettings__warning--show")},this.bleedHandler=function(e){return t.lastBleed=e.target,setTimeout(function(){this.lockBleed&&this.updateAllBleed(e.target.value)}.bind(t),0),!0},this.bleedChainHandler=function(e){return t.lockBleed=!t.lockBleed,e.target.dispatchEvent(new Event("change",{bubbles:!0})),t.lockBleed&&t.updateAllBleed(t.lastBleed.value),!0},this.toggleColorModeHandler=function(e){setTimeout(function(){iaw.util.smoothScroll(this.docsettingsScrollContainer,this.docsettingsScrollContainer.scrollHeight-this.docsettingsScrollContainer.offsetHeight,300)}.bind(t),100)},this.on("mount",function(){this.data=e.__proto__;var t=iaw.store.get(["host","fnftSettings"])||{};this.docSizeBounds=t.docSizeBounds||[3e5,3e5],this.units=t.units||[],this.colorModes=t.colorMode||[],this.pointsPerInch=t.pointsPerInch||72,this.picasPerInch=iaw.util.roundDecimal(this.pointsPerInch/this.constant.POINTS_PER_PICA,4),this.defaultUnits=this.data.units||"inchesUnit",this.currentUnit=this.defaultUnits,this.defaultColorMode=this.data.mode||"CMYK",this.maxDocWidth=this.docSizeBounds[0],this.maxDocHeight=this.docSizeBounds[1],this.minDocWidth=1,this.minDocHeight=1,this.artboardCount=this.data.numArtboards||0,this.currentHeight=this.data.height,this.currentWidth=this.data.width,this.artBoardMin=1,this.artBoardMax=100,this.leftBleedValue=this.data.appSpecificKey?this.data.appSpecificKey.bleedOffset[0]:0,this.topBleedValue=this.data.appSpecificKey?this.data.appSpecificKey.bleedOffset[1]:0,this.rightBleedValue=this.data.appSpecificKey?this.data.appSpecificKey.bleedOffset[2]:0,this.bottomBleedValue=this.data.appSpecificKey?this.data.appSpecificKey.bleedOffset[3]:0,this.lockBleed=!this.data.appSpecificKey||"undefined"==typeof this.data.appSpecificKey.lockBleed||this.data.appSpecificKey.lockBleed,this.bleedMin=0,this.bleedMax=72,this.lastBleed=this.topbleed,this.convertedMaxDocWidth,this.convertedMaxDocHeight,this.convertedMinDocWidth,this.convertedMinDocHeight,this.convertedMinBleed,this.convertedMaxBleed,this.appSpecificKey=JSON.parse(JSON.stringify(this.data.appSpecificKey||{})),this.initialSettings={width:this.data.width,height:this.data.height,units:this.data.units,mode:this.data.mode,numArtboards:this.data.numArtboards},riotctrl.on("update-i18n-retro",this.onLoc,this),this.dropDownElements=document.querySelectorAll(".spc-dropdown"),this.convertBounds(this.conversionMappings[this.currentUnit]),this.colorModesInput.addEventListener("toggle",this.toggleColorModeHandler)}),this.on("before-unmount",function(){riotctrl.off("update-i18n-retro",this.onLoc,this),this.colorModesInput.removeEventListener("toggle",this.toggleColorModeHandler),this.off("*")}),this.onLoc=function(){t.customizeLabel=iaw.i18n.getLocalizedString("newdoc_button_customize_ai"),t.defaultDocumentName=iaw.store.get(["input","doc-name"])||iaw.store.get(["host","fnftSettings","documentName"])||iaw.i18n.getLocalizedString("newdoc_default_docname"),t.heading=iaw.i18n.getLocalizedString("newdoc_details_label_title"),t.widthLabel=iaw.i18n.getLocalizedString("newdoc_details_label_width"),t.heightLabel=iaw.i18n.getLocalizedString("newdoc_details_label_height"),t.colorModeLabel=iaw.i18n.getLocalizedString("newdoc_details_label_colormode"),t.bleedLabel=iaw.i18n.getLocalizedString("newdoc_details_label_bleed"),t.topLabel=iaw.i18n.getLocalizedString("newdoc_details_label_top"),t.bottomLabel=iaw.i18n.getLocalizedString("newdoc_details_label_bottom"),t.leftLabel=iaw.i18n.getLocalizedString("newdoc_details_label_left"),t.rightLabel=iaw.i18n.getLocalizedString("newdoc_details_label_right"),t.orientationLabel=iaw.i18n.getLocalizedString("newdoc_details_label_orientation"),t.artboardLabel=iaw.i18n.getLocalizedString("newdoc_details_label_artboards"),t.colorModeWarning=iaw.i18n.getLocalizedString("newdoc_ai_colormode_warning"),t.localizedUnits=t.localizeArray("newdoc_details_",t.units),t.localizedColorModes=t.localizeArray("newdoc_details_colormode_",t.colorModes),t.update(),t.validateNumericFields(),t.setStore(),t.mixin("spcmixin")}});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};riot.tag2("preset-form-phxs",'<div class="sidebar-padding" if="{!presetMode}"><h6 class="spc-typography--caption preset-form__caption">{heading}</h6></div><form name="docsettings" class="docsettings__form" onchange="{validateNumericFields}" onkeypress="{formKeypressHandler}" onclick="{formClickHandler}"><div class="preset-disclosure" if="{presetMode}"><h6 class="spc-typography--caption preset-form__caption">{presetHeading}</h6><div class="docsettings__doc-name spc-textfield spc-js-textfield spc-textfield--quiet" id="presetNameTextField"><input id="formPresetName" class="spc-textfield__input" type="text" onkeyup="{testValidPresetName}" value="{defaultPresetName}"><span class="spc-textfield__error">{presetCollisionLabel}</span></div><div class="preset-button-container"><button id="presetSaveCancel" class="spc-button" onclick="{toggleSavePreset}">{cancel}</button><button id="presetSaveCommit" class="spc-button spc-button--cta" onclick="{savePreset}">{savePresetLabel}</button></div></div><div name="docsettingsScrollContainer" class="form-preset__container scroll-container"><div class="scroll-pane" riot-style="width: {scrollPaneWidth}px"><div class="docsettings__doc-name spc-textfield spc-js-textfield spc-textfield--quiet document-name" if="{!presetMode}"><input name="formName" class="spc-textfield__input ps-document-name__input" type="text" value="{defaultDocumentName}" pattern="{fileNameValidationPattern}" onchange="{documentNameChangeHandler}" onclick="{selectInput}"><i class="inapp-icons inapp-icon--preset docsettings__save-preset-button" onclick="{toggleSavePreset}"></i></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{widthLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2 docsettings--flex-start"><div class="spc-textfield spc-js-textfield"><input name="formWidth" onclick="{selectInput}" onwheel="{incrementSupport()}" onkeydown="{incrementSupport()}" class="spc-textfield__input" pattern="[0-9]*" min="{convertedMinDocWidth}" step="{1 / Math.pow(10, roundingRules[currentUnit])}" max="{convertedMaxDocWidth}" value="{iaw.util.roundDecimal(currentWidth, roundingRules[currentUnit])}" type="{\'number\'}"></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{heightLabel}</span></div></div><div class="docsettings__row"><div class="spc-textfield spc-js-textfield docsettings--no-margin"><input name="formHeight" onclick="{selectInput}" onwheel="{incrementSupport()}" onkeydown="{incrementSupport()}" class="spc-textfield__input" pattern="[0-9]*" step="{1 / Math.pow(10, roundingRules[currentUnit])}" min="{convertedMinDocHeight}" max="{convertedMaxDocHeight}" value="{iaw.util.roundDecimal(currentHeight, roundingRules[currentUnit])}" type="{\'number\'}"></div><div class="docsettings--grow-5"></div></div></div><div class="docsettings--grow-5"><div name="unitDropdown" onchange="{unitDropdownHandler}" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{widthLabel}</em></div><hr class="spc-dropdown__divider"><div name="unitselection" class="spc-dropdown__options"><div class="{is-checked: defaultUnits === unit.value} spc-dropdown__option" data-value="{unit.value}" each="{unit in localizedUnits}" if="{unit.value !== \'columnsUnit\'}"> {unit.localizedValue} </div></div></div></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-1"><div class="docsettings__row"><div class="docsettings--grow-1"><span class="docsettings__field-label spc-textfield--left-label">{orientationLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-1 docsettings__orientation-input" name="orientationInput"><label class="spc-icon-toggle spc-js-icon-toggle" for="orientationPortrait"><input id="orientationPortrait" type="checkbox" value="portrait" class="spc-icon-toggle__input {is-checked: orientationIsPortrait}" __checked="{orientationIsPortrait}" onchange="{orientationChangeHandler}"><i class="spc-icon-toggle__label inapp-icons inapp-icon--portrait"></i></label><label class="spc-icon-toggle spc-js-icon-toggle" for="orientationLandscape"><input id="orientationLandscape" type="checkbox" value="landscape" class="spc-icon-toggle__input {is-checked: !orientationIsPortrait}" __checked="{!orientationIsPortrait}" onchange="{orientationChangeHandler}"><i class="spc-icon-toggle__label inapp-icons inapp-icon--landscape"></i></label></div></div></div><div class="docsettings--grow-1 docsettings--stretch"><div class="docsettings__row"><div class="docsettings--grow-1"><span class="docsettings__field-label--nowrap spc-textfield--left-label">{artboardLabel}</span></div></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-1"><label class="spc-checkbox spc-js-checkbox" class="{is-checked: artboards.length > 0, spc-checkbox, spc-js-checkbox}" for="artboardInput"><input type="checkbox" __checked="{artboards.length > 0}" id="artboardInput" class="spc-checkbox__input" onchange="{artboardInputChangeHandler}"></label></div></div></div></div></div></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{resolutionLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2"><div class="spc-textfield spc-js-textfield"><input name="formResolution" onclick="{selectInput}" onwheel="{incrementSupport(0.1)}" onkeydown="{incrementSupport(0.1)}" class="spc-textfield__input" pattern="[0-9]*" min="{iaw.util.ceilDecimal(minResolution, roundingRules[\'resolution\'])}" max="{iaw.util.floorDecimal(maxResolution, roundingRules[\'resolution\'])}" step="0.001" value="{iaw.util.roundDecimal(currentResolution, roundingRules[\'resolution\'])}" type="{\'number\'}"></div></div><div class="docsettings--grow-5"><div name="resolutionUnitDropdown" onchange="{resolutionUnitDropdownHandler}" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{resolutionLabel}</em></div><hr class="spc-dropdown__divider"><div name="unitselection" class="spc-dropdown__options"><div class="{is-checked: defaultResolutionUnits === resolutionUnit.value} spc-dropdown__option" data-value="{resolutionUnit.value}" each="{resolutionUnit in localizedResolutionUnits}"> {resolutionUnit.localizedValue} </div></div></div></div></div></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{colorModeLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2"><div name="colorModesInput" onchange="{colorModeChangeHandler}" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{colorModeLabel}</em></div><hr class="spc-dropdown__divider"><div class="spc-dropdown__options"><div class="{is-checked: defaultColorMode === mode.mode} spc-dropdown__option" data-values="{JSON.stringify(mode.values)}" data-value="{mode.mode}" each="{mode in availableColorModes}"> {mode.localizedValue} </div></div></div></div></div><div class="docsettings--grow-1-half"><div name="depthInput" onchange="{depthChangeHandler}" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>Unit</em></div><hr class="spc-dropdown__divider"><div class="spc-dropdown__options"><div each="{depth in colorDepthOptions}" class="{is-checked: depth === currentColorModeDepth} spc-dropdown__option" data-value="{depth}"> {depth} {localizeBitValue(depth)} </div></div></div></div></div></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{backgroundLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-3"><div name="backgroundInput" class="spc-dropdown spc-js-dropdown" tabindex="0" onchange="{backgroundInputHandler}"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{backgroundLabel}</em></div><hr class="spc-dropdown__divider"><div name="unitselection" class="spc-dropdown__options"><div class="{is-checked: defaultBackgroundColor === bg.value} spc-dropdown__option" data-value="{bg.value}" each="{bg in availableBackgroundValues}"> {bg.localizedValue} </div></div></div></div></div><div class="docsettings--grow-1"><div name="backgroundColorPicker" class="color-picker__container"><div class="color-picker__color-swatch" onclick="{backgroundColorSwatchHandler}" riot-style="background-color:{customBackgroundRGB}"></div></div></div></div><div class="docsettings__disclosure-container"><div class="docsettings__disclosure-header" onclick="{toggleAdvancedOptions}"><span class="docsettings__disclosure-indicator spc-icons {docsettings__disclosure-indicator--closed: advancedClosed}">D</span><span>{customizeLabel}</span></div><div class="docsettings__disclosure-contents {docsettings__disclosure-contents--closed: advancedClosed}" name="advancedOptionsContents" riot-style="min-height:{getAdvancedDialogHeight()}px"><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{colorProfileLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2"><div name="colorProfileInput" class="spc-dropdown spc-js-dropdown" onchange="{colorProfileInputHandler}" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{colorProfileLabel}</em></div><hr class="spc-dropdown__divider"><div name="profileselection" class="spc-dropdown__options"><div data-value="{sublist}" each="{sublist in (colorProfileList)}"><div class="{is-checked: colorProfile === profile.value} spc-dropdown__option" data-value="{profile.value}" each="{profile in (sublist)}"> {profile.label} </div><hr class="spc-dropdown__divider"></div></div></div></div></div></div><div class="docsettings__row docsettings__row--spacing"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{pixelScaleLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2"><div name="pixelScaleInput" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{pixelScaleLabel}</em></div><hr class="spc-dropdown__divider"><div name="scaleselection" class="spc-dropdown__options"><div class="{is-checked: pixelScale === scale.value} spc-dropdown__option" data-value="{scale.value}" each="{scale in pixelScaleList}"> {scale.label} </div></div></div></div></div></div></div></div></div></div></form><action-footer if="{!presetMode}"></action-footer>',"","",function(e){var t=this;this.mixin("unitConversion"),this.mixin("cooldown"),this.constants={POINTS_PER_PICA:12},this.conversionMappings={pixelsUnit:"px",millimetersUnit:"mm",centimetersUnit:"cm",inchesUnit:"in",picasUnit:"pc",pointsUnit:"pt"},this.roundingRules={pixelsUnit:0,millimetersUnit:2,centimetersUnit:2,inchesUnit:3,picasUnit:2,pointsUnit:1,resolution:3},this.defaultMinResolution=1,this.defaultMaxResolution=29999.99,this.cancel="",this.savePresetLabel="",this.customizeLabel="",this.defaultDocumentName="",this.defaultPresetName="",this.heading="",this.presetHeading="",this.presetCollisionLabel="",this.widthLabel="",this.presetText="",this.heightLabel="",this.resolutionLabel="",this.colorModeLabel="",this.backgroundLabel="",this.colorProfileLabel="",this.pixelScaleLabel="",this.orientationLabel="",this.artboardLabel="",this.localizedUnits=[],this.localizedResolutionUnits=[],this.localizedBackgroundValues=[],this.availableBackgroundValues=[],this.localizedColorModes=[],this.availableColorModes=[],this.advancedDialogHeight=0,this.scrollPaneWidth=284;var i=iaw.util.isWindowsOS();this.fileNameReplaceRegex=i?/[<>:"\/\\|?*]/g:/[:]/g,this.fileNameValidationPattern=i?'[^<>:"/\\\\|?*]+':"[^:]+",this.orientationIsPortrait=!0,this.localizeArray=function(e,t){var i=[];if(Array.isArray(t)){var o,n;for(o=0,n=t.length;o<n;o++)"string"==typeof t[o]?i.push({value:t[o],localizedValue:iaw.i18n.getLocalizedString(e+t[o])}):"object"===_typeof(t[o])&&i.push({values:t[o].values,mode:t[o].mode,localizedValue:iaw.i18n.getLocalizedString(e+t[o].mode)})}return i},this.localizeBitValue=function(e){return iaw.i18n.getLocalizedString("newdoc_details_colormode_bit_"+e)},this.onAction=function(e){var t=e.target.dataset.action;riotctrl.trigger(t)},this.updateSavedPreset=function(e){if(!e)return void console.error("Failed to updateSavedPreset because no data was provided");var t,i=window.__adobe_cep__?iaw.apps.phxs.convertPsPresetToCCXPresetEntry(JSON.parse(e),"saved",iaw.store.get("phxsFNFTConfigInfo")):e,o=iaw.store.get("presets"),n=iaw.store.get("presetLUT");o.filter(function(e){return"saved"===e.template_category}).some(function(e){if(e.name.localeCompare(i.name)>0)return t=e,!0});var s=o.length;t&&(s=n[t.uuid]);var a=iaw.util.generateGUID();i.uuid=a,o.splice(s,0,i);for(var r in n)n.hasOwnProperty(r)&&n[r]>=s&&(n[r]=n[r]+1);n[a]=s,iaw.store.set("presets",o),iaw.store.set("presetLUT",n),setTimeout(function(){riotctrl.trigger(iaw.fnftEvents.FILTER,"saved",i.title)},0)},this.savePreset=function(e){var i=document.getElementById("formPresetName").value,o=iaw.store.get("presets");o=o.filter(function(e){return"recent"!==e.template_category}),o.some(function(e){return e.name===i},t)||""!==i.trim()&&(iaw.fnft.createPreset(i,t.updateSavedPreset),t.toggleSavePreset())},this.toggleSavePreset=function(e){if(!t.presetMode){var i=iaw.store.get("presets");i=i.filter(function(e){return"recent"!==e.template_category});for(var o=0,n=!0,s=iaw.i18n.getLocalizedString("newdoc_filter_saved");n;)++o,n=i.some(function(e){return e.name===s+" "+o.toString()});t.defaultPresetName=s+" "+o,iaw.store.set(["input","preset-name"],t.defaultPresetName)}iaw.localstorage.setUserItem("fnft.presetMode",!t.presetMode),t.update({presetMode:!t.presetMode}),t.presetMode&&t.formPresetName&&setTimeout(function(){t.formPresetName.select()},0)},this.setStore=function(){var e=t.unitDropdown.querySelector(".is-checked"),i=t.resolutionUnitDropdown.querySelector(".is-checked"),o=t.colorModesInput.querySelector(".is-checked"),n=t.depthInput.querySelector(".is-checked"),s=t.colorProfileInput.querySelector(".is-checked"),a=t.pixelScaleInput.querySelector(".is-checked"),r=t.defaultBackgroundColor;"custom"===r&&t.customBackgroundColorObject instanceof Object&&(r=t.customBackgroundColorObject),t.colorProfile=s&&s.dataset.value,t.pixelScale=a&&parseFloat(a.dataset.value),iaw.store.set(["input","doc-name"],t.validateName(t.formName.value)||t.defaultDocumentName),document.getElementById("formPresetName")&&iaw.store.set(["input","preset-name"],document.getElementById("formPresetName").value||t.defaultPresetName);var l=iaw.store.merge(["input","settings"],{width:t.currentWidth,units:e.dataset.value,height:t.currentHeight,resolution:parseFloat(t.formResolution.value),resolutionUnits:i.dataset.value,mode:o&&o.dataset&&o.dataset.value,depth:n&&n.dataset&&parseInt(n.dataset.value),profile:t.colorProfile,scale:t.pixelScale,fill:r,artboards:t.artboards,attributesChanged:!1});t.settingsChanged(t.initialSettings,l)?(l.name="",l.attributesChanged=!0):l.name=t.data.name,l.height!==t.initialSettings.height||l.width!==t.initialSettings.width?l.guides=[]:l.guides=t.data.guides},this.check=function(e){e.checked||(e.checked=!0,e.parentElement.classList.add("is-checked"))},this.uncheck=function(e){e.checked&&(e.checked=!1,e.parentElement.classList.remove("is-checked"))},this.closeDropDownsExcept=function(e){var i,o;for(i=0,o=t.dropDownElements.length;i<o;i++)t.dropDownElements[i].contains(e)||t.dropDownElements[i].classList.remove("is-open")},this.settingsChanged=function(e,i){var o;for(o in e)if("name"!==o&&e.hasOwnProperty(o)&&i.hasOwnProperty(o)){if(void 0===e[o])continue;if("object"===_typeof(e[o])){if("object"!==_typeof(i[o]))return!0;if(Array.isArray(e[o])&&(!Array.isArray(i[o])||i[o].length!==e[o].length))return!0;if(!Array.isArray(e[o]))return t.settingsChanged(e[o],i[o])}else if(e[o]!==i[o])return!0}return!1},this.validateName=function(e){return e=e.replace(t.fileNameReplaceRegex,"_")},this.validateNumericFields=function(){function e(e,t,i,o){return Math.max(Math.min(Number(e)||t,o),i)}var i=e(t.formResolution.value,t.currentResolution,t.minResolution,t.maxResolution),o=iaw.util.roundDecimal(i,t.roundingRules.resolution),n=iaw.util.roundDecimal(t.currentResolution,t.roundingRules.resolution);t.formResolution.value=o,o!==n&&(t.currentResolution=i,t.calculateDimensionLimits(t.conversionMappings[t.currentUnit]));var s=t.roundingRules[t.currentUnit],a=e(t.formWidth.value,t.currentWidth,t.convertedMinDocWidth,t.convertedMaxDocWidth),r=e(t.formHeight.value,t.currentHeight,t.convertedMinDocHeight,t.convertedMaxDocHeight),l=iaw.util.roundDecimal(a,s),c=iaw.util.roundDecimal(r,s),d=iaw.util.roundDecimal(t.currentWidth,s),u=iaw.util.roundDecimal(t.currentHeight,s);t.formHeight.value=c,t.formWidth.value=l,u===c&&d===l||(t.currentHeight=r,t.currentWidth=a,t.calculateResolutionLimits()),t.formName.parentElement.classList.remove("is-invalid"),t.formHeight.parentElement.classList.remove("is-invalid"),t.formWidth.parentElement.classList.remove("is-invalid"),t.formResolution.parentElement.classList.remove("is-invalid"),t.updateArtboards(),t.updateOrientationIcons(),t.setStore()},this.getAdvancedDialogHeight=function(){return this.advancedDialogHeight=this.advancedDialogHeight||Math.round(.6*this.docsettingsScrollContainer.clientHeight),this.advancedDialogHeight},this.updateOrientationIcons=function(){t.currentHeight>=t.currentWidth?(t.orientationIsPortrait=!0,t.check(t.orientationPortrait),t.uncheck(t.orientationLandscape)):(t.orientationIsPortrait=!1,t.uncheck(t.orientationPortrait),t.check(t.orientationLandscape))},this.toggleOrientation=function(){var e=t.formWidth.value;t.formWidth.value=t.formHeight.value,t.formHeight.value=e},this.updateArtboards=function(){t.artboardInput.checked===!0?t.artboards=[{bottom:t.conversionHelper(t.currentHeight,t.conversionMappings[t.currentUnit],"px"),left:0,right:t.conversionHelper(t.currentWidth,t.conversionMappings[t.currentUnit],"px"),top:0}]:t.artboards=[]},this.setColorMode=function(e,i){var o,n;if(!i){var s=t.localizedColorModes.filter(function(t){return t.mode===e});i=s[0]&&s[0].values||[8]}o=i.indexOf(t.currentColorModeDepth)===-1?i[0]:t.currentColorModeDepth,n=t.getColorProfileState(e,o),iaw.util.assign(n,t.getBackgroundState(e)),n.currentColorModeDepth=o,n.colorDepthOptions=i,n.defaultColorMode=e,t.update(n),t.colorModesInput.dispatchEvent(new Event("change",{bubbles:!0})),t.colorProfileInput.dispatchEvent(new Event("change",{bubbles:!0})),t.backgroundInput.dispatchEvent(new Event("change",{bubbles:!0})),t.depthInput.dispatchEvent(new Event("change",{bubbles:!0}))},this.deriveColorMode=function(e){var i,o=t.colorProfileLists;if(!o||!e)return"RGB";for(var n in o){for(var s in o[n]){var a=o[n][s];if(Array.isArray(a)&&a.indexOf(e)>-1){i=n;break}}if(i)break}return i||"RGB"},this.getColorDepthValuesByName=function(e){var i,o;for(i=0,o=t.colorModes.length;i<o;i++)if(t.colorModes[i].mode===e)return t.colorModes[i].values;return[]},this.getColorProfileList=function(e,i){function o(e){return e.reduce(function(e,t){return e.push({value:t,label:t}),e},[])}var n,s=iaw.store.get(["host","fnftSettings"]),a=s&&s.colorSettings||{},r=a[e]&&a[e].policy,l=a[e]&&a[e].workingProfile,c=a[e]&&a[e].workingDisplayText,d={value:"default",label:c||iaw.i18n.getLocalizedString("newdoc_details_label_workingProfile")},u={value:l||"default",label:c||iaw.i18n.getLocalizedString("newdoc_details_label_workingProfile")},p={value:"none",label:iaw.i18n.getLocalizedString("newdoc_details_label_noColorManage")},h=[];return h[0]=[],32!==i&&h[0].push(p),["Lab","bitmap"].indexOf(e)===-1&&("off"!==r?h[0].unshift(d):h[0].push(u)),t.colorProfileLists&&["RGB","CMYK","grayscale"].indexOf(e)>=0&&t.colorProfileLists.hasOwnProperty(e)?(n=t.colorProfileLists[e],h.push(o(n.STANDARD)),h.push(o(n.OTHER)),h):h},this.getColorProfileState=function(e,i){var o=t.getColorProfileList(e,i),n=t.colorProfile,s={colorProfileList:o},a=n&&o.some(function(e){return e.some(function(e){return e&&e.value===n})});return a||(s.colorProfile=o[0]&&o[0][0]&&o[0][0].value),s},this.getBackgroundState=function(e){if("bitmap"!==e)return{availableBackgroundValues:t.localizedBackgroundValues};var i=t.localizedBackgroundValues.filter(function(e){return"transparent"!==e.value}),o={availableBackgroundValues:i},n=i.some(function(e){return e&&e.value===t.defaultBackgroundColor});return n||(o.defaultBackgroundColor=i[0]&&i[0].value),o},this.getColorModeState=function(e){if(!e)return{availableColorModes:t.localizedColorModes};var i=t.localizedColorModes.filter(function(e){return"RGB"===e.mode}),o={availableColorModes:i},n=i.some(function(e){return e&&e.mode===t.defaultColorMode});return n||(o.defaultColorMode=i[0]&&i[0].mode),o},this.calculateDimensionLimits=function(e){t.convertedMaxDocWidth=t.conversionHelper(t.maxDocWidth,"px",e),t.convertedMaxDocHeight=t.conversionHelper(t.maxDocHeight,"px",e),t.convertedMinDocWidth=t.conversionHelper(t.minDocWidth,"px",e),t.convertedMinDocHeight=t.conversionHelper(t.minDocHeight,"px",e),t.convertedMaxDocWidth=iaw.util.floorDecimal(t.convertedMaxDocWidth,t.roundingRules[t.currentUnit]),t.convertedMaxDocHeight=iaw.util.floorDecimal(t.convertedMaxDocHeight,t.roundingRules[t.currentUnit]),t.convertedMinDocWidth=iaw.util.ceilDecimal(t.convertedMinDocWidth,t.roundingRules[t.currentUnit]),t.convertedMinDocHeight=iaw.util.ceilDecimal(t.convertedMinDocHeight,t.roundingRules[t.currentUnit])},this.calculateResolutionLimits=function(){if("pixelsUnit"===t.currentUnit)t.maxResolution=t.defaultMaxResolution,t.minResolution=t.defaultMinResolution;else{var e=t.minDocHeight/t.currentHeight,i=t.maxDocHeight/t.currentHeight,o=t.minDocWidth/t.currentWidth,n=t.maxDocWidth/t.currentWidth,s=Math.max(o,e),a=Math.min(n,i),r=t.conversionHelper(s,"in",t.conversionMappings[t.currentUnit]),l=t.conversionHelper(a,"in",t.conversionMappings[t.currentUnit]),c=Math.max(r,t.defaultMinResolution),d=Math.min(l,t.defaultMaxResolution);t.minResolution=t.conversionHelper(c,t.conversionMappings[t.currentResolutionUnit],"in"),t.maxResolution=t.conversionHelper(d,t.conversionMappings[t.currentResolutionUnit],"in")}},this.conversionHelper=function(e,i,o){if(i===o)return e;var n=t.conversionMappings[t.currentResolutionUnit],s="in"!==n?t.convert(t.currentResolution).from("in").to(n):t.currentResolution,a=t.convert(e,{pointsPerInch:t.pointsPerInch,resolution:s,picasPerInch:t.picasPerInch,trim:!1}).from(i).to(o);return a},this.setCustomBackgroundRGB=function(){var e=function(e){return"RGBColor"!==e.type?(iaw.apps.phxs.convertColorToRGB(e).then(function(e){e&&e instanceof Object&&this.update({customBackgroundRGB:iaw.apps.phxs.rgbFormat(e)})}.bind(this),function(t){console.error("Failed to convert color to rgb",e,t)}.bind(this)),"rgba(0,0,0,0)"):iaw.apps.phxs.rgbFormat(e)}.bind(t);switch(t.defaultBackgroundColor){case"background":t.customBackgroundRGB=e(t.photoshopBackgroundColor);break;case"custom":t.customBackgroundRGB=e(t.customBackgroundColorObject);break;case"white":t.customBackgroundRGB="rgb(255, 255, 255)";break;case"black":t.customBackgroundRGB="rgb(0, 0, 0)";break;default:t.customBackgroundRGB="rgba(0, 0, 0, 0)"}},this.selectInput=function(e){e.target.select()},this.documentNameChangeHandler=function(){t.formName.value=t.validateName(t.formName.value)||t.defaultDocumentName},this.orientationChangeHandler=function(e){return e.target.checked?(t.toggleOrientation(),!0):(t.updateOrientationIcons(),!1)},this.artboardInputChangeHandler=function(){var e=t.getColorModeState(t.artboardInput.checked);t.update(e),e.hasOwnProperty("defaultColorMode")?t.setColorMode(t.defaultColorMode):t.colorModesInput.dispatchEvent(new Event("change",{bubbles:!0}))},this.unitDropdownHandler=function(e){var i=e.target.dataset.value;t.currentWidth=t.conversionHelper(t.currentWidth,t.conversionMappings[t.currentUnit],t.conversionMappings[i]),t.currentHeight=t.conversionHelper(t.currentHeight,t.conversionMappings[t.currentUnit],t.conversionMappings[i]),t.currentUnit=i,t.calculateDimensionLimits(t.conversionMappings[i])},this.resolutionUnitDropdownHandler=function(e){var i=e.target.dataset.value;t.currentResolution=t.conversionHelper(t.currentResolution,t.conversionMappings[i],t.conversionMappings[t.currentResolutionUnit]),t.currentResolutionUnit=i,t.calculateDimensionLimits(t.conversionMappings[t.currentUnit]),t.calculateResolutionLimits()},this.colorProfileInputHandler=function(e){if(!e.target.dataset||!e.target.dataset.value)return void e.preventDefault()},this.backgroundInputHandler=function(e){if(e.preventDefault(),e.target.dataset&&e.target.dataset.value){var i=t.backgroundInput.querySelector(".is-checked");t.defaultBackgroundColor=i.dataset.value,"custom"===t.defaultBackgroundColor&&(t.customBackgroundColorObject||(t.customBackgroundColorObject=t.photoshopBackgroundColor),setTimeout(function(){t.backgroundColorSwatchHandler();
},0)),t.setCustomBackgroundRGB(),t.setStore()}},this.backgroundColorSwatchHandler=function(){if(!t.isCoolingDown(4)){var e;switch(t.defaultBackgroundColor){case"background":e=t.photoshopBackgroundColor;break;case"custom":e=t.customBackgroundColorObject;break;case"black":e={red:0,grain:0,blue:0,type:"RGBColor"};break;default:e={red:255,grain:255,blue:255,type:"RGBColor"}}iaw.apps.phxs.promptForCustomColor(e).then(function(e){e&&(this.customBackgroundColorObject=e,this.defaultBackgroundColor="custom",this.setCustomBackgroundRGB(),this.setStore(),this.update(),this.backgroundInput.dispatchEvent(new Event("change",{bubbles:!0})))}.bind(t))}},this.testValidPresetName=function(e){var i=document.getElementById("formPresetName"),o=i.value,n=iaw.store.get("presets");n=n.filter(function(e){return"recent"!==e.template_category});var s=n.some(function(e){return e.name===o},t),a=!1;s?(t.presetCollisionLabel=iaw.i18n.getLocalizedString("new_preset_details_collision_title"),a=!0,i.parentElement.classList.add("is-invalid")):""===o.trim()?(t.presetCollisionLabel=iaw.i18n.getLocalizedString("new_preset_details_empty_title"),i.parentElement.classList.add("is-invalid"),a=!0):i.parentElement.classList.remove("is-invalid");var r=document.getElementById("presetSaveCommit");return r&&(r.disabled=a),t.update(),!0},this.formKeypressHandler=function(e){if(e.keyCode===iaw.a11y.Keys.ENTER){if(e.stopPropagation(),t.validateNumericFields(),t.presetMode){var i=document.getElementById("presetSaveCancel");i&&i===document.activeElement?t.toggleSavePreset():t.savePreset()}else riotctrl.trigger("host-create-template-doc");return!1}return!0},this.formClickHandler=function(e){return t.closeDropDownsExcept(e.srcElement),!0},this.depthChangeHandler=function(e){if(e.preventDefault(),e.target.dataset&&e.target.dataset.value){var i=parseInt(e.target.dataset.value),o=t.getColorProfileState(t.defaultColorMode,i);o.currentColorModeDepth=i,t.update(o),t.setStore(),t.colorProfileInput.dispatchEvent(new Event("change",{bubbles:!0}))}},this.colorModeChangeHandler=function(e){if(e.preventDefault(),e.target.dataset&&e.target.dataset.value){var i=e.target.dataset.value,o=e.target.dataset.values&&JSON.parse(e.target.dataset.values);t.setColorMode(i,o),t.setStore()}},this.incrementSupport=function(e){return function(t){if("wheel"!==t.type||(t.preventDefault(),!this.isCoolingDown(0,40))){var i,o=t.target,n="pixelsUnit"===this.currentUnit?1:.1;if(o===document.activeElement)return t.keyCode&&t.keyCode===iaw.a11y.Keys.DOWN||t.wheelDelta&&t.wheelDelta<0?i="down":(t.keyCode&&t.keyCode===iaw.a11y.Keys.UP||t.wheelDelta&&t.wheelDelta>0)&&(i="up"),e=e||n,event.shiftKey&&(e*=10),"up"===i?(t.preventDefault(),o.value=iaw.util.roundDecimal(Number(o.value)+e,3),o.dispatchEvent(new Event("change",{bubbles:!0})),o.select()):"down"===i&&(t.preventDefault(),o.value=iaw.util.roundDecimal(Number(o.value)-e,3),o.dispatchEvent(new Event("change",{bubbles:!0})),o.select()),!0}}},this.toggleAdvancedOptions=function(){t.advancedClosed?(t.update({advancedClosed:!t.advancedClosed}),iaw.localstorage.setUserItem("fnft.advancedClosed",t.advancedClosed),t.scrollBy(t.docsettingsScrollContainer,t.advancedDialogHeight,300)):t.scrollBy(t.docsettingsScrollContainer,-t.advancedDialogHeight,300,function(){this.update({advancedClosed:!this.advancedClosed}),iaw.localstorage.setUserItem("fnft.advancedClosed",this.advancedClosed)}.bind(t))},this.scrollBy=function(e,t,i,o){function n(e,t,i,o){return e/=o/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)}function s(){l+=c,a=n(l,r,t,i),e.scrollTop=a,l<i?requestAnimationFrame(s):"function"==typeof o&&o()}var a,r=e.scrollTop,l=0,c=20;i="undefined"==typeof i?500:i,s()},this.onAction=function(e){var i=e.target.dataset.action;if("host-more-options"===i){var o=iaw.store.get(["input","settings"]),n={presetAttributes:{attributes:t.initialSettings,newAttributes:o,attributesChanged:o.attributesChanged}};o.attributesChanged=n.presetAttributes.attributesChanged,iaw.util.assign(n,t.data),iaw.analytics.ingest.logFNFTActionClickedEvent("more-options",n)}riotctrl.trigger(i)},this.on("mount",function(){var t=this;this.data=e.__proto__;var i=iaw.store.get(["host","fnftSettings"]),o=iaw.store.get(["input","settings"]),n=iaw.localstorage.getUserItem("fnft.advancedClosed");this.presetMode=iaw.localstorage.getUserItem("fnft.presetMode")!==!1,this.docSizeBounds=i.docSizeBounds||[3e5,3e5],this.units=i.units||[],this.resolutionUnits=i.resolutionUnits||[],this.colorModes=i.colorModes.slice(0)||[],this.backgroundValues=i.backgroundValues.slice(0)||[],this.photoshopBackgroundColor=i.backgroundColor,this.pointsPerInch=i.pointsPerInch||72,this.colorProfileLists=i.colorProfileLists,this.pixelScaleList=i.pixelAspectRatios,this.picasPerInch=iaw.util.roundDecimal(this.pointsPerInch/this.constants.POINTS_PER_PICA,4),this.advancedClosed=n!==!1,this.presetNameInvalid=!1,this.initialSettings=iaw.util.assign({},i.defaultPresetSettings,o,{name:this.data.name,width:this.data.width,height:this.data.height,fill:this.data.fill,units:this.data.units,resolutionUnits:this.data.resolutionUnits,resolution:this.data.resolution,mode:this.data.mode,depth:this.data.depth,profile:this.data.profile,artboards:this.data.artboards,scale:this.data.scale,attributesChanged:!1}),this.data.profile&&!this.data.mode&&(this.initialSettings.mode=this.deriveColorMode(this.data.profile)),"default"===this.initialSettings.profile&&i.colorSettings[this.initialSettings.mode]&&"off"===i.colorSettings[this.initialSettings.mode].policy&&(this.initialSettings.profile="none"),"RGB"!==this.initialSettings.mode&&(this.initialSettings.artboards=[]),iaw.store.set(["input","settings"],{}),iaw.store.deepMerge(["input","settings"],this.initialSettings),this.defaultUnits=this.initialSettings.units||"inchesUnit",this.currentUnit=this.defaultUnits,this.defaultResolutionUnits=this.initialSettings.resolutionUnits||"inchesUnit",this.currentResolutionUnit=this.defaultResolutionUnits,this.defaultColorMode=this.initialSettings.mode,this.colorProfile=this.initialSettings.profile||"",this.pixelScale=this.initialSettings.scale||1,this.currentResolution=this.initialSettings.resolution||72,this.currentColorModeDepth=this.initialSettings.depth||8,this.maxDocWidth=this.docSizeBounds[0],this.maxDocHeight=this.docSizeBounds[1],this.minDocWidth=1,this.minDocHeight=1,this.artboards=this.initialSettings.artboards||[],this.currentHeight=this.initialSettings.height,this.currentWidth=this.initialSettings.width,this.orientationIsPortrait=this.currentHeight>=this.currentWidth,this.convertedMaxDocWidth,this.convertedMaxDocHeight,this.convertedMinDocWidth,this.convertedMinDocHeight,this.initialSettings.fill instanceof Object?(this.customBackgroundColorObject=this.initialSettings.fill,this.defaultBackgroundColor="custom"):(this.customBackgroundColorObject=null,this.defaultBackgroundColor=this.initialSettings.fill||"white"),this.setCustomBackgroundRGB(),this.scrollPaneWidth=Math.max(200,this.docsettings.clientWidth),this.calculateDimensionLimits(this.conversionMappings[this.currentUnit]),this.calculateResolutionLimits(),this.colorDepthOptions=this.getColorDepthValuesByName(this.defaultColorMode),this.dropDownElements=document.querySelectorAll(".spc-dropdown"),riotctrl.on("update-i18n-retro",this.onLoc,this),this.docsettings.addEventListener("click",function(e){t.closeDropDownsExcept(e.srcElement)})}),this.on("before-unmount",function(){riotctrl.off("update-i18n-retro",this.onLoc,this),this.off("*")}),this.onLoc=function(){t.customizeLabel=iaw.i18n.getLocalizedString("newdoc_button_customize"),t.defaultDocumentName=iaw.store.get(["input","doc-name"])||iaw.store.get(["host","fnftSettings","defaultDocumentName"])||iaw.i18n.getLocalizedString("newdoc_default_docname"),t.defaultPresetName=iaw.store.get(["input","preset-name"]),t.heading=iaw.i18n.getLocalizedString("newdoc_details_label_title"),t.presetHeading=iaw.i18n.getLocalizedString("new_preset_details_label_title"),t.widthLabel=iaw.i18n.getLocalizedString("newdoc_details_label_width"),t.presetCollisionLabel=iaw.i18n.getLocalizedString("new_preset_details_collision_title"),t.presetText=iaw.i18n.getLocalizedString("newdoc_details_label_preset"),t.heightLabel=iaw.i18n.getLocalizedString("newdoc_details_label_height"),t.resolutionLabel=iaw.i18n.getLocalizedString("newdoc_details_label_resolution"),t.colorModeLabel=iaw.i18n.getLocalizedString("newdoc_details_label_colormode"),t.backgroundLabel=iaw.i18n.getLocalizedString("newdoc_details_label_background"),t.colorProfileLabel=iaw.i18n.getLocalizedString("newdoc_details_label_colorProfile"),t.pixelScaleLabel=iaw.i18n.getLocalizedString("newdoc_details_label_pixelScale"),t.orientationLabel=iaw.i18n.getLocalizedString("newdoc_details_label_orientation"),t.artboardLabel=iaw.i18n.getLocalizedString("newdoc_details_label_artboards"),t.localizedBackgroundValues=t.localizeArray("newdoc_details_backgroundcolor_",t.backgroundValues),t.availableBackgroundValues=t.localizedBackgroundValues,t.localizedUnits=t.localizeArray("newdoc_details_",t.units),t.localizedResolutionUnits=t.localizeArray("newdoc_details_resolution_",t.resolutionUnits),t.localizedColorModes=t.localizeArray("newdoc_details_colormode_",t.colorModes),t.availableColorModes=t.localizedColorModes,t.cancel=iaw.i18n.getLocalizedString("cancel"),t.savePresetLabel=iaw.i18n.getLocalizedString("newdoc_details_label_save_preset");var e=t.getColorModeState(t.artboards&&t.artboards.length);t.update(e);var i=t.getColorProfileState(t.defaultColorMode,t.currentColorModeDepth);t.update(i),t.validateNumericFields(),t.mixin("spcmixin")}});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};riot.tag2("preset-form-simu",'<div class="sidebar-padding"><h6 class="spc-typography--caption preset-form__caption">{heading}</h6></div><div class="form-preset__container scroll-container"><div class="scroll-pane"><form id="docsettings-form" name="docsettings" class="docsettings__form"><div class="docsettings__doc-name spc-textfield spc-js-textfield spc-textfield--quiet"><input name="formName" class="spc-textfield__input" type="text" value="{defaultDocumentName}"></div><div class="docsettings__row"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{widthLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2"><div class="spc-textfield spc-js-textfield spc-textfield--quiet"><input id="form-width" class="spc-textfield__input" min="{this.convertedMinDocWidth}" step="{1 / Math.pow(10, roundingRules[currentUnit])}" max="{this.convertedMaxDocWidth}" value="{currentWidth}" type="{\'number\'}"></div></div><div class="docsettings--grow-5"><div id="form-unit-width" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{widthLabel}</em></div><hr class="spc-dropdown__divider"><div name="unitselection" class="spc-dropdown__options"><div class="{is-checked: defaultUnits === unit.value, spc-dropdown__option:true}" data-value="{unit.value}" each="{unit in localizedUnits}" if="{unit.value !== \'columnsUnit\'}"> {unit.localizedValue} </div></div></div></div></div></div><div class="docsettings__row"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{heightLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2"><div class="spc-textfield spc-js-textfield spc-textfield--quiet"><input id="form-height" class="spc-textfield__input" step="{1 / Math.pow(10, roundingRules[currentUnit])}" min="{this.convertedMinDocHeight}" max="{this.convertedMaxDocHeight}" value="{currentHeight}" type="{\'number\'}"></div></div><div class="docsettings--grow-5"></div></div><div class="docsettings__row docsettings__row--extra-padding"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{colorModeLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2"><div id="form-color-modes" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{colorModeLabel}</em></div><hr class="spc-dropdown__divider"><div class="spc-dropdown__options"><div class="{is-checked: defaultColorMode === mode.mode, spc-dropdown__option:true}" data-values="{JSON.stringify(mode.values)}" data-value="{mode.mode}" each="{mode in localizedColorModes}"> {mode.localizedValue} </div></div></div></div></div><div class="docsettings--grow-2"><div id="form-color-mode-depth" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>Unit</em></div><hr class="spc-dropdown__divider"><div class="spc-dropdown__options"><div each="{bits in colorModeOptions}" class="{is-checked: bits === currentColorModeDepth, spc-dropdown__option:true}" data-value="{bits}"> {bits} {localizeBitValue(bits)} </div></div></div></div></div></div><div class="docsettings__row docsettings__row--extra-padding"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{backgroundLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-2"><div id="form-background" class="spc-dropdown spc-js-dropdown" tabindex="0"><div class="spc-dropdown__inner"><div class="spc-dropdown__selected"><em>{backgroundLabel}</em></div><hr class="spc-dropdown__divider"><div name="unitselection" class="spc-dropdown__options"><div class="{is-checked: defaultBackgroundColor === bg.value, spc-dropdown__option:true}" data-value="{bg.value}" each="{bg in localizedBackgroundValues}"> {bg.localizedValue} </div></div></div></div></div></div><div class="docsettings__row"><div class="docsettings--grow-3"><span class="docsettings__field-label spc-textfield--left-label">{orientationLabel}</span></div></div><div class="docsettings__row"><div class="docsettings--grow-3" id="form-orientation"><label class="spc-icon-toggle spc-js-icon-toggle" for="orientation-portrait"><input type="checkbox" id="orientation-portrait" value="portrait" class="spc-icon-toggle__input" checked><i class="spc-icon-toggle__label inapp-icons inapp-icon--portrait"></i></label><label class="spc-icon-toggle spc-js-icon-toggle" for="orientation-landscape"><input type="checkbox" id="orientation-landscape" value="landscape" class="spc-icon-toggle__input"><i class="spc-icon-toggle__label inapp-icons inapp-icon--landscape"></i></label></div></div><div class="docsettings__row docsettings__row--artboard"><div class="docsettings--grow-1"><label class="spc-checkbox spc-js-checkbox" class="{is-checked: artboards.length > 0, spc-checkbox, spc-js-checkbox}" for="form-artboards"><input type="checkbox" __checked="{artboards.length > 0}" id="form-artboards" class="spc-checkbox__input"><span class="docsettings__field-label spc-textfield--left-label">{artboardLabel}</span></label></div></div></form><br><button class="spc-button" onclick="{onAction}" data-action="host-more-options">{customizeLabel}</button></div></div><action-footer></action-footer>',"","",function(e){var t=this;this.defaultUnits="inchesUnit",this.customizeLabel="",this.defaultDocumentName="",this.heading="",this.widthLabel="",this.heightLabel="",this.resolutionLabel="",this.colorModeLabel="",this.backgroundLabel="",this.orientationLabel="",this.artboardLabel="",this.bitsLabel="",this.localizedUnits=[],this.localizedResolutionUnits=[],this.localizedBackgroundValues=[],this.localizedColorModes=[],this.localizeIt=function(e,t){var i=[];if(Array.isArray(t)){var o,n;for(o=0,n=t.length;o<n;o++)"string"==typeof t[o]?i.push({value:t[o],localizedValue:iaw.i18n.getLocalizedString(e+t[o])}):"object"===_typeof(t[o])&&i.push({values:t[o].values,mode:t[o].mode,localizedValue:iaw.i18n.getLocalizedString(e+t[o].mode)})}return i},this.recordText=function(e){iaw.store.set(["input","doc-name"],e.target.value)},this.onAction=function(e){var t=e.target.dataset.action;riotctrl.trigger(t)},this.validateName=function(e){return e=e.replace(new RegExp(":","g"),"-"),e=e.replace(new RegExp("\\\\","g"),"\\\\")},this.setStore=function(){var e=document.getElementById("form-width"),i=document.getElementById("form-height"),o=document.querySelector("#form-color-modes .is-checked"),n=document.querySelector("#form-background .is-checked"),s=document.getElementById("form-artboards"),a=n.dataset.value;"custom"===a&&t.customBackgroundColorObject instanceof Object&&(a=t.customBackgroundColorObject);var r;s.checked===!0&&(r=[{bottom:t.conversionHelper(parseFloat(i.value),t.conversionMapping[t.currentUnit],"px"),left:0,right:t.conversionHelper(parseFloat(e.value),t.conversionMapping[t.currentUnit],"px"),top:0}]),iaw.store.set(["input","doc-name"],t.validateName(t.formName.value)||t.defaultDocumentName);var l=iaw.store.set(["input","settings"],{width:parseFloat(e.value),height:parseFloat(i.value),mode:o.dataset.value,fill:a,artboards:r});l.height!==t.initialSettings.height||l.width!==t.initialSettings.width?l.guides=[]:l.guides=t.data.guides},this.toggleWidthAndHeight=function(){var e;this.formWidthEl.value<this.formHeightEl.value&&this.orientationLandscape.checked?(e=this.formWidthEl.value,this.formWidthEl.value=this.formHeightEl.value,this.formHeightEl.value=e):this.formWidthEl.value>this.formHeightEl.value&&this.orientationPortrait.checked&&(e=this.formWidthEl.value,this.formWidthEl.value=this.formHeightEl.value,this.formHeightEl.value=e)},this.toggleOrientation=function(e){this.toggleWidthAndHeight(),e===this.orientationPortrait?(this.check(this.orientationPortrait),this.uncheck(this.orientationLandscape)):(this.uncheck(this.orientationPortrait),this.check(this.orientationLandscape))},this.check=function(e){e.checked=!0,e.parentElement.classList.add("is-checked")},this.uncheck=function(e){e.checked=!1,e.parentElement.classList.remove("is-checked")},this.closeDropDownsExcept=function(e){var t,i;for(t=0,i=this.dropDownElements.length;t<i;t++)this.dropDownElements[t].contains(e)||this.dropDownElements[t].classList.remove("is-open")},this.updateDropDownWithValue=function(e,t){if(e){var i=t.querySelector('input[value="'+e+'"]');i.checked=!0,i.dispatchEvent(new Event("change",{bubbles:!0}))}},this.validateNumericFields=function(){if(this.formHeightEl){var e=Number(this.formHeightEl.value),t=Number(this.formWidthEl.value);(isNaN(e)||0===e)&&(e=this.currentHeight),(isNaN(t)||0===t)&&(t=this.currentWidth),t>this.maxDocWidth&&(t=this.maxDocWidth),e>this.maxDocHeight&&(e=this.maxDocHeight),e>t?(this.check(this.orientationPortrait),this.uncheck(this.orientationLandscape)):e<t&&(this.uncheck(this.orientationPortrait),this.check(this.orientationLandscape)),this.currentWidth=t,this.currentHeight=e,this.formWidthEl.value=t,this.formHeightEl.value=e}},this.getColorModeValuesByName=function(e){var t,i;for(t=0,i=this.colorModes.length;t<i;t++)if(this.colorModes[t].mode===e)return this.colorModes[t].values;return[]},this.conversionMapping={pixelsUnit:"px",millimetersUnit:"mm",centimetersUnit:"cm",inchesUnit:"in",picasUnit:"pc",pointsUnit:"pt"},this.on("mount",function(){var t=this;this.data=e.__proto__;var i=iaw.store.get(["host","fnftSettings"]);this.docSizeBounds=i.docSizeBounds||[3e5,3e5],this.units=i.units||[],this.colorModes=i.colorModes||[],this.backgroundValues=i.backgroundValues||[],this.pointsPerInch=i.pointsPerInch||72,this.defaultUnits=this.data.units||"inchesUnit",this.currentUnit=this.defaultUnits,this.defaultBackgroundColor=this.data.fill||"white",this.defaultColorMode=this.data.mode||"RGB",this.defaultColorModeValue=8,this.maxDocWidth=this.docSizeBounds[0],this.maxDocHeight=this.docSizeBounds[1],this.currentHeight=this.data.height||1,this.currentWidth=this.data.width||1,this.initialSettings={width:this.data.width,height:this.data.height,fill:this.data.fill,units:this.data.units,resolutionUnits:this.data.resolutionUnits,resolution:this.data.resolution,mode:this.data.mode,depth:this.data.depth,artboards:this.data.artboards},this.colorModeOptions=this.getColorModeValuesByName(this.defaultColorMode),riotctrl.on("update-i18n-retro",this.onLoc,this),this.dropDownElements=document.querySelectorAll(".spc-dropdown");var o=document.querySelector("#form-unit-width"),n=document.getElementById("docsettings-form"),s=document.getElementById("form-color-modes");this.orientationPortrait=document.getElementById("orientation-portrait"),this.orientationLandscape=document.getElementById("orientation-landscape"),this.orientationInput=document.getElementById("form-orientation"),this.formWidthEl=document.getElementById("form-width"),this.formHeightEl=document.getElementById("form-height"),s.addEventListener("change",function(e){t.colorModeOptions=JSON.parse(e.target.dataset.values),t.colorModeOptions.indexOf(t.defaultColorModeValue)===-1&&(t.defaultColorModeValue=t.colorModeOptions[0]),t.update();var i=document.querySelector('input[value="'+t.defaultColorModeValue+'"]');i.checked=!0,i.dispatchEvent(new Event("change",{bubbles:!0}))}),this.orientationInput.addEventListener("change",function(e){t.toggleOrientation(e.target)}),n.addEventListener("click",function(e){t.closeDropDownsExcept(e.srcElement)}),n.addEventListener("change",function(e){t.validateNumericFields(),t.setStore()}),o.addEventListener("change",function(e){t.formWidthEl.value=iaw.util.unitConversion(t.formWidthEl.value,{pointsPerInch:t.pointsPerInch}).from(t.conversionMapping[t.currentUnit]).to(t.conversionMapping[e.target.value]),t.formHeightEl.value=iaw.util.unitConversion(t.formHeightEl.value,{pointsPerInch:t.pointsPerInch}).from(t.conversionMapping[t.currentUnit]).to(t.conversionMapping[e.target.value]),t.currentUnit=e.target.value})}),this.on("before-unmount",function(){riotctrl.off("update-i18n-retro",this.onLoc,this),this.off("*")}),this.onLoc=function(){t.customizeLabel=iaw.i18n.getLocalizedString("newdoc_button_customize"),t.defaultDocumentName=iaw.i18n.getLocalizedString("newdoc_default_docname"),t.heading=iaw.i18n.getLocalizedString("newdoc_details_label_title"),t.widthLabel=iaw.i18n.getLocalizedString("newdoc_details_label_width"),t.heightLabel=iaw.i18n.getLocalizedString("newdoc_details_label_height"),t.colorModeLabel=iaw.i18n.getLocalizedString("newdoc_details_label_colormode"),t.backgroundLabel=iaw.i18n.getLocalizedString("newdoc_details_label_background"),t.orientationLabel=iaw.i18n.getLocalizedString("newdoc_details_label_orientation"),t.artboardLabel=iaw.i18n.getLocalizedString("newdoc_details_label_artboards"),t.bitsLabel=iaw.i18n.getLocalizedString("newdoc_details_colormode_bit_1"),t.localizedBackgroundValues=t.localizeIt("newdoc_details_backgroundcolor_",t.backgroundValues),t.localizedUnits=t.localizeIt("newdoc_details_",t.units),t.localizedResolutionUnits=t.localizeIt("newdoc_details_",t.resolutionUnits),t.localizedColorModes=t.localizeIt("newdoc_details_colormode_",t.colorModes),t.update(),t.validateNumericFields(),t.setStore(),t.mixin("spcmixin")}}),riot.tag2("preview-nav",'<button class="back-button" onclick="{handleBackAction}"><i class="inapp-icons inapp-icon--left"></i><span class="back-button__label" data-i18n="back"></span></button><div class="spc-layout-spacer"></div><span if="{iaw.util.currentBreakPoint === iaw.fnft.RWD_SMALL}" class="preview-nav__actions"><button class="spc-button" onclick="{handleBackAction}" data-i18n="close_preview"></button><button class="spc-button spc-button--cta" onclick="{onAction}" data-action="host-screen-template" data-i18n="download"></button></span><div class="preview-nav__progress hidden"><span class="">{downloadStatus}</span><div class="spc-progress spc-js-progress"></div></div>',"",'class="hidden"',function(e){var t=this;this.mixin("i18n"),this.mixin("spcmixin"),this.mixin("cooldown");var i=!1;this.downloadStatus="",this.downloadStarted=!1,this.template=null,this.leaf=null,this.onAction=function(e){var i=e.target.dataset.action;switch(i){case"host-close-fnft":if(t.isCoolingDown(0))return;break;case"host-screen-template":if(t.isCoolingDown(1))return}riotctrl.trigger(i)},this.updateProgress=function(e){var i=t.root.querySelector(".spc-js-progress");i.SpectreProgress.setProgress(e)},this.resetVisibility=function(){var e=t.root.querySelector(".preview-nav__progress"),i=t.root.querySelector(".preview-nav__actions");e&&e.classList.add("hidden"),i&&i.classList.remove("hidden"),t.update()},this.onDownloadStart=function(){t.downloadStarted=!0;var e=t.root.querySelector(".preview-nav__progress"),i=t.root.querySelector(".preview-nav__actions");e&&e.classList.remove("hidden"),i&&i.classList.add("hidden");var o=t.root.querySelector('[data-i18n="open"');o&&(o.innerText=iaw.i18n.getLocalizedString("download")),t.downloadStatus="",t.update()},this.onDownloadEnd=function(){var e=t.root.querySelector('[data-i18n="download"');e&&(e.innerText=iaw.i18n.getLocalizedString("open"))},this.handleBackAction=function(){iaw.analytics.ingest.logFNFTActionClickedEvent("preview-back",iaw.store.get(["input","preview-item"])),t.toggle()},this.toggle=function(){if(!t.isCoolingDown(2,300)){if(i)return iaw.util.hideElement(t.root),riotctrl.trigger("close-preview"),void(i=!1);i=!0;var e=iaw.store.get(["input","download-status"]);if(t.template=iaw.store.get(["input","preview-item"]),e&&e.templateId===t.template.id)e.downloadStatus===iaw.libraryManager.DOWNLOADED?(t.resetVisibility(),t.onDownloadEnd()):(t.onDownloadStart(),t.updateProgress(e.progress));else{t.resetVisibility(),t.updateProgress(0);var o=t.root.querySelector('[data-i18n="open"');o&&(o.innerText=iaw.i18n.getLocalizedString("download"))}iaw.util.showElement(t.root),t.update(),iaw.analytics.ingest.logFNFTActionClickedEvent("preview",iaw.store.get(["input","preview-item"]))}},this.on("mount before-unmount",function(e){"mount"===e?(riotctrl.on("toggle-nav-overlay",this.toggle,this),riotctrl.on("update-host-retro",this.onHost,this)):"before-unmount"===e&&(this.off("*"),riotctrl.off("toggle-nav-overlay",this.toggle,this),riotctrl.off("update-host-retro",this.onHost,this))}),this.onHost=function(){t.leaf=iaw.store.select(["input","download-status"]),t.leaf.on("update",t.onDownloadStatus)},this.onDownloadStatus=function(e){if(t.template){var i=e.data.currentData;if(i.templateId===t.template.id){if(i.downloadStatus===iaw.libraryManager.DOWNLOADED)return t.resetVisibility(),t.onDownloadEnd(),void t.update();if(0===i.progress||!t.downloadStarted)return void t.onDownloadStart();var o=i.progress/100*t.template.size,n=iaw.util.createFileSizeString(t.template.size),s=iaw.util.createFileSizeString(o);t.downloadStatus=s+" "+iaw.i18n.getLocalizedString("of")+" "+n,t.updateProgress(i.progress),t.update()}}}}),riot.tag2("preview-overlay",'<div class="nav-placeholder"></div><div class="scroll-container"><div class="scroll-pane"><img if="{preview}" riot-src="{preview}"></div></div>',"","",function(e){var t=this;this.mixin("i18n"),this.mixin("spcmixin"),this.preview=null,this.hide=function(){iaw.util.unmountTag(t)},this.show=function(){var e=iaw.store.get(["input","preview-item"]);e&&e.previews&&e.previews.length>0&&(t.preview=e.previews[0].url||null),iaw.analytics.ingest.logFNFTActionClickedEvent("render-preview",e),riotctrl.trigger("toggle-nav-overlay"),t.update()},this.on("mount before-unmount",function(e){"mount"===e?(riotctrl.on("close-preview",this.hide,this),this.show()):"before-unmount"===e&&(riotctrl.off("close-preview",this.hide,this),this.off("*"))})}),riot.tag2("screen-download",'<span class="spc-typography--headline" data-i18n="newdoc_bigtemplate_header">This is a big file</span><span class="screen-download__lovenote" data-i18n="newdoc_bigtemplate_body"></span><span class="screen-download__actions"><button class="spc-button" onclick="{hide}" data-i18n="cancel">Cancel</button><button class="spc-button spc-button--cta" onclick="{continueDL}" data-i18n="continue">Continue</button></span><label class="spc-checkbox spc-js-checkbox" for="dont-show-dl-screen"><input type="checkbox" id="dont-show-dl-screen" class="spc-checkbox__input"><span class="spc-checkbox__label" data-i18n="never_show_again">Don\'t show again</span></label>',"",'class="fullscreen-overlay hidden"',function(e){var t=this;this.mixin("i18n"),this.mixin("spcmixin"),this.mixin("cooldown"),this.show=function(){iaw.util.showElement(t.root),t.update();var e=t.root.querySelector(".spc-button--cta");e.focus()},this.hide=function(){if(!t.isCoolingDown(0)){iaw.util.hideElement(t.root);var e=document.querySelector(".template-grid-item--active");e=e.querySelector("button"),e.focus()}},this.continueDL=function(e){if(!t.isCoolingDown(1)){var i=document.getElementById("dont-show-dl-screen").checked;iaw.localstorage.setUserItem("fnft.showFilesizeWarning",!i),riotctrl.trigger("host-license-template"),t.hide()}},this.on("mount",function(){riotctrl.on("host-download-template--large",this.show,this)}),this.on("before-unmount",function(){riotctrl.off("host-download-template--large")})}),riot.tag2("template-download","","","hidden",function(e){this.onStartLicense=function(e){var t=iaw.libraryManager.TEMPLATE_ELEMENT_TYPE,i=iaw.store.get(["input","preview-item"]);if(i&&i.id&&i.price_prompt){if(!window.__adobe_cep__){var o=0,n=setInterval(function(){if(o+=20,o>=100){var e={title:i.title,templateId:i.id,downloadStatus:iaw.libraryManager.DOWNLOADED,path:"some/fake/path"};return iaw.store.set(["input","download-status"],e),iaw.libraryManager.statusLookupMap[i.id]={templateId:i.id,downloadStatus:iaw.libraryManager.DOWNLOADED,path:i.url},void clearInterval(n)}i.template_category instanceof Array?i.template_category.push("saved","recent"):i.template_category=[i.template_category,"saved","recent"],iaw.store.set(["input","download-status"],{title:i.title,templateId:i.id,size:i.size,downloadStatus:iaw.libraryManager.DOWNLOADING,progress:o,downloadPending:!0})},200);return void iaw.store.set(["input","download-status"],{templateId:i.id,size:i.size||0,downloadStatus:iaw.libraryManager.DOWNLOADING,progress:0,downloadPending:!0})}iaw.cepUtil.isUserSignedIn(function(e,o){e&&!iaw.libraryManager.isTemplateDownloading(i.id)&&iaw.libraryManager.getTemplateLibrary().then(function(e){var o="undefined"!=typeof i.is_free?i.is_free:"free"===i.price_prompt,n={path:i.thumbnail_url,width:i.thumbnail_width,height:i.thumbnail_height};iaw.util.showLicenseDialog({type:t,title:i.title},i.id,o,e.id,n).then(function(){iaw.store.set(["input","download-status"],{templateId:i.id,size:i.size||0,downloadStatus:iaw.libraryManager.DOWNLOADING,progress:0,downloadPending:!0})}),iaw.analytics.pip.logFNFTDataGroupEvent("Download Template",{id:String(i.id),name:i.title})})["catch"](function(e){iaw.log.logJSON("load library error: ",e),iaw.store.set(["input","download-status"],{title:i.title,templateId:i.id,size:i.size,downloadStatus:iaw.libraryManager.DOWNLOAD_ERR,err:e})})})}},this.onDownloading=function(e){e&&e.downloadPending&&(e.progress=e.progress||0,iaw.store.set(["input","download-status"],{templateId:e.templateId,downloadStatus:"downloading",size:e.size||0,progress:e.progress||0}))},this.on("mount before-unmount",function(e){"mount"===e?riotctrl.on("host-license-template",this.onStartLicense,this):"before-unmount"===e&&(riotctrl.off("host-license-template",this.onStartLicense,this),this.off("*"))})}),riot.tag2("template-form-stock",'<div class="sidebar-padding"><h6 class="spc-typography--caption preset-form__caption" data-i18n="newdoc_details_label_template_title"></h6><h6 class="spc-typography--title preset-form__title {preset-form__title--small-margin: showAttribution}">{data.title}</h6><div class="form-stock__attribution" if="{showAttribution}">{byLabel} <a class="form-stock__attribution__link" onclick="{openAttributionLink}" href="{this.data.contributor_url}">{data.contributor_name}</a></div><a class="form-stock__more-link" onclick="{openStockLink}"><img src="images/products/product-rune-STCK.png"><span data-i18n="adobe_stock"></span></a></div><div class="form-stock__desc scroll-container"><div class="scroll-pane"><span class="form-stock__desc-content"></span><div class="form-stock__price">{data.price_prompt}</div><div if="{sizeVisible}" class="form-stock__info"><span data-i18n="listview_size_header"></span>: <span>{iaw.util.createFileSizeString(data.size)}</span></div><button if="{previewButtonVisible}" class="spc-button spc-button--secondary form-stock__preview-btn" onclick="{togglePreviewer}" data-i18n="newdoc_button_preview"></button></div></div><div class="action-footer"><button class="spc-button" onclick="{onAction}" __disabled="{previewVisible}" data-action="host-close-fnft" data-i18n="close"></button><button class="spc-button spc-button--cta" onclick="{onAction}" data-action="host-screen-template" data-i18n="download"></button></div>',"","",function(e){
var t=this;this.mixin("i18n"),this.mixin("cooldown"),this.defaultDocumentName="",this.dlStatus=null,this.previewVisible=!1,this.sizeVisible=!0,this.previewButtonVisible=!0,this.showAttribution=!1,this.onAction=function(e){var i=e.target.dataset.action,o=null;switch(i){case"host-close-fnft":if(t.isCoolingDown(0))return;o="close-template";break;case"host-screen-template":if(t.isCoolingDown(1))return}o&&iaw.analytics.ingest.logFNFTActionClickedEvent(o,iaw.store.get(["input","selected-item"])),riotctrl.trigger(i)},this.openStockLink=function(){if(!t.isCoolingDown(3)){var e=iaw.util.openStockLink(iaw.store.get(["host","hostID"]),t.data.template_category[0]),i=iaw.store.get(["input","preview-item"]);i.actionURL=e,iaw.analytics.ingest.logFNFTActionClickedEvent("stock-sidebar",i),iaw.analytics.pip.logFNFTDataGroupEvent("Jump to Stock",{category:i.activeFilter,id:String(i.id),name:i.title})}},this.openAttributionLink=function(e){if(e.preventDefault(),!t.isCoolingDown(4)){var i=e.target.getAttribute("href");window.__adobe_cep__?iaw.util.openDefaultBrowserAuthenicated("adobeStock",i):window.open(i)}},this.updateContent=function(e){var t=document.querySelector(".form-stock__desc-content");t.innerHTML=marked(e)},this.toggleBackgroundItemVisibility=function(e){var t;e?(t=document.querySelector(".template-nav"),t.classList.remove("invisible"),t=document.querySelector(".scroll-pane"),t.classList.remove("invisible")):(t=document.querySelector(".template-nav"),t.classList.add("invisible"),t=document.querySelector(".scroll-pane"),t.classList.add("invisible"))},this.togglePreviewer=function(e){var i=e.target.dataset.i18n;if(!t.isCoolingDown(2,400)){if("close_preview"===i)return riotctrl.trigger("close-preview"),riotctrl.trigger("toggle-nav-overlay"),e.target.dataset.i18n="newdoc_button_preview",iaw.analytics.ingest.logFNFTActionClickedEvent("preview-close",iaw.store.get(["input","preview-item"])),void t.toggleBackgroundItemVisibility(!0);t.previewVisible=!0,t.toggleBackgroundItemVisibility(!1),iaw.util.currentBreakPoint===iaw.fnft.RWD_SMALL?iaw.util.mountTag("#template-preview--large","preview-overlay"):iaw.util.mountTag("#template-preview--small","preview-overlay"),e.target.dataset.i18n="close_preview",e.target.blur()}},this.on("mount",function(){if(riotctrl.on("update-i18n-retro",this.onLoc,this),riotctrl.on("close-preview",this.updateButton,this),this.dlStatus=iaw.store.select(["input","download-status"]),this.dlStatus.on("update",this.downloadComplete),this.data=e.__proto__,this.showAttribution=this.data.contributor_name&&""!==this.data.contributor_name&&this.data.contributor_url&&""!==this.data.contributor_url,this.sizeVisible="undefined"!=typeof this.data.size,this.previewButtonVisible=this.data.previews&&this.data.previews.length>0,"undefined"!=typeof marked?this.updateContent(this.data.description):riotctrl.once("markdown-ready-retro",function(){this.updateContent(this.data.description),this.update()},this),iaw.libraryManager.isTemplateLicensed(this.data.id)){var t=this.root.querySelector(".action-footer .spc-button--cta");t.dataset.i18n="open",t.dataset.action="host-create-template-doc"}this.update()}),this.on("before-unmount",function(){riotctrl.off("update-i18n-retro",this.onLoc,this),riotctrl.off("close-preview",this.updateButton,this),this.off("*")}),this.downloadComplete=function(e){var i=e&&e.data&&e.data.currentData;if(i.templateId===t.data.id&&i.downloadStatus===iaw.libraryManager.DOWNLOADED){var o=t.root.querySelector(".action-footer .spc-button--cta");o&&(o.dataset.i18n="open",o.dataset.action="host-create-template-doc");var n=iaw.store.get(["templateLUT",t.data.uuid]),s=iaw.store.get(["templates",n]);s.url=i.path,s.elementRef=i.elementRef,iaw.store.set(["input","selected-item"],s.uuid),t.data=s,t.update()}},this.onLoc=function(){t.cancelLabel=iaw.i18n.getLocalizedString("close"),t.byLabel=iaw.i18n.getLocalizedString("by"),iaw.store.set(["input","doc-name"],t.defaultDocumentName),t.update()},this.updateButton=function(){var e=t.root.querySelector(".form-stock__preview-btn");e.dataset.i18n="newdoc_button_preview",t.previewVisible=!1,t.toggleBackgroundItemVisibility(!0),t.update()}}),riot.tag2("preset-grid-item",'<div class="preset-grid-item__thumbnail"><i class="inapp-icons-preset inapp-icons-preset--{preseticon}"></i></div><div class="preset-grid-item__info"><span class="preset-grid-item__name truncate-text">{this.title}</span><span class="preset-grid-item__desc truncate-text">{desc}</span></div><button class="preset-grid-item__overlay" onfocus="{onFocus}" tabindex="{active ? \'0\' : \'-1\'}"></button><button class="preset-grid-item__delete anim--fade-in-fast spc-icons spc-icon--trash" onkeydown="{onDelete}" onclick="{onDelete}"></button>',"",'onkeydown="{keyDown}" ondblclick="{doubleClicked}" data-tip="{opts.data.tip}" class="anim--fade-in-fast grid-cell grid-cell--autoSize {preset-grid-item--active: active}"',function(e){var t=this;this.mixin("tooltip"),this.mixin("spcmixin");var i=e.data.uuid;this.inputCursor=null,this.thumb="images/thumbs/"+e.data.thumbnail_url,this.active=!1,this.preseticon="",this.title="",this.desc="",this.category="",this.getData=function(){var i=!!e.__proto__.data;return i?e.__proto__.data:t._item},this.autoClick=function(){t.root.querySelector("button").focus(),t.active||t.handleSelected(!0)},this.onFocus=function(e){return!t.active&&void t.handleSelected(!1)},this.onDelete=function(e){if("keydown"===e.type){if(e.keyCode!==iaw.a11y.Keys.ENTER&&e.keyCode!==iaw.a11y.Keys.SPACE)return!0;e.stopPropagation()}iaw.fnft.deletePreset(t.title);var o=iaw.store.get("presets"),n=iaw.store.get("presetLUT");delete o[n[i]],delete n[i],iaw.store.get(["input","selected-item"])===i&&iaw.store.set(["input","selected-item"],null);var s=null;t.root.previousSibling?s=t.root.previousSibling._tag?t.root.previousSibling._tag.title:null:t.root.nextSibling&&(s=t.root.nextSibling._tag?t.root.nextSibling._tag.title:null),riotctrl.trigger(iaw.fnftEvents.FILTER,iaw.store.get(["input","active-filter"]),s,!0)},this.handleSelected=function(e){if(!t.active){var o=t.getData(),n=iaw.store.get(["host","hostID"]).toLowerCase();e||iaw.analytics.ingest.logFNFTActionClickedEvent("preset-selected",o),iaw.store.set(["input","selected-item"],i),riot.mount("#sidebar-container","preset-form-"+n,o)}},this.resetIcon=function(e){switch(e){case"SP_PresetArt.png":t.preseticon="art";break;case"SP_PresetClipboard.png":t.preseticon="clipboard";break;case"SP_PresetCustom.png":t.preseticon="saved"===t.category?"saved":"custom";break;case"SP_PresetFilmVideo.png":t.preseticon="video";break;case"SP_PresetIconographyDoc.png":case"SP_PresetSurfacePro.png":case"SP_PresetMobileAppDoc.png":case"SP_PresetMobilePhoneDoc.png":case"SP_PresetTabletApp.png":t.preseticon="mobile";break;case"SP_PresetPhotoDoc.png":t.preseticon="photo";break;case"SP_PresetWebDoc.png":t.preseticon="web";break;case"SP_PrintDoc.png":t.preseticon="print";break;default:t.preseticon="custom"}t.update()},this.doubleClicked=function(e){iaw.analytics.ingest.logFNFTActionClickedEvent("preset-create",t.getData()),riotctrl.trigger("host-create-template-doc")},this.keyDown=function(e){return e.keyCode===iaw.a11y.Keys.ENTER&&(e.stopPropagation(),iaw.analytics.ingest.logFNFTActionClickedEvent("preset-create",t.getData()),riotctrl.trigger("host-create-template-doc")),!0},this.on("mount before-unmount",function(t){if("mount"===t){var o=e.data;this.title=o.title,this.desc=o.description,this.category=o.template_category,this.inputCursor=iaw.store.select("input"),this.inputCursor.on("update",this.onInput,{scope:this}),this.resetIcon(e.data.thumbnail_url),iaw.store.get(["input","selected-item"])===i&&(this.active=!0,this.update())}else"before-unmount"===t&&this.off("*")}),this.onInput=function(e){t.active=e.data.currentData["selected-item"]===i,t.update()}}),riot.tag2("template-grid-item",'<div class="template-grid-item__thumbnail" riot-style="background-image: url(\'{opts.data.thumbnail_url}\')"></div><div class="template-grid-item__info"><span class="template-grid-item__name">{opts.data.title}</span><span if="{activeFilter !== \'recent\' && activeFilter !== \'saved\'}" class="spc-layout-spacer"></span><span if="{activeFilter !== \'recent\' && activeFilter !== \'saved\'}" class="template-grid-item__price">{opts.data.price_prompt}</span></div><div class="template-grid-item--licensed hidden"><i class="inapp-icons inapp-icon--check"></i></div><div class="spc-layout__container hidden"><div class="spc-progress spc-js-progress"></div><div class="template-grid-item__error hidden"></div><span>{downloadStatus}</span></div><button class="template-grid-item__overlay" onfocus="{onFocus}" tabindex="{active ? \'0\' : \'-1\'}"></button>',"",'onkeydown="{keyDown}" ondblclick="{onAction}" class="anim--fade-in-fast grid-cell grid-cell--autoSize {template-grid-item--active: active}"',function(e){var t=this;this.mixin("spcmixin");var i=e.data.uuid;this.inputCursor=null,this.dlStatus=null,this.active=!1,this.activeFilter="recent",this.downloadStatus="",this.downloadStarted=!1,this.downloadEnded=!1,this.getData=function(){var i=!!e.__proto__.data;return i?e.__proto__.data:t._item},this.keyDown=function(e){return e.keyCode===iaw.a11y.Keys.ENTER&&t.onAction(),!0},this.onAction=function(){if(!t.isDownloading()){var i=!!e.__proto__.data,o=i?e.__proto__.data:t;iaw.libraryManager.isTemplateLicensed(o.id)?riotctrl.trigger("host-create-template-doc"):riotctrl.trigger("host-screen-template")}},this.autoClick=function(){t.root.querySelector("button").focus(),t.active||t.onFocus()},this.onFocus=function(e){if(t.active)return!1;var o=t.getData();iaw.analytics.ingest.logFNFTActionClickedEvent("template-selected",o),riot.mount("#sidebar-container","template-form-stock",o),iaw.store.set(["input","selected-item"],i),iaw.store.set(["input","preview-item"],o)},this.isDownloading=function(){return t.downloadStarted===!0&&t.downloadEnded===!1},this.onDownloadStart=function(e){t.downloadStarted=!0,t.clearError();var i=t.root.querySelector(".spc-layout__container");i&&i.classList.remove("hidden"),t.updateProgress(e),t.update()},this.onDownloadEnd=function(){t.downloadEnded=!0;var e=t.root.querySelector(".spc-layout__container");e.classList.add("hidden"),e=t.root.querySelector(".template-grid-item--licensed"),e.classList.remove("hidden"),t.autoClick()},this.updateProgress=function(e){var i=t.getData(),o=t.root.querySelector(".spc-js-progress");o.SpectreProgress.setProgress(e.progress),e.size=e.size||i.size;var n=e.progress/100*e.size,s=iaw.util.createFileSizeString(e.size),a=0===n?"0":iaw.util.createFileSizeString(n);t.downloadStatus=a+" "+iaw.i18n.getLocalizedString("of")+" "+s},this.showError=function(e){t.downloadStatus=e||"default error message.",t.update();var i=t.root.querySelector(".template-grid-item__error");i&&i.classList.remove("hidden");var o=t.root.querySelector(".spc-layout__container");o&&o.classList.add("hidden")},this.clearError=function(){var e=t.root.querySelector(".template-grid-item__error");e&&e.classList.add("hidden")},this.on("mount before-unmount",function(t){if("mount"===t){this.inputCursor=iaw.store.select("input"),this.inputCursor.on("update",this.onInput),this.dlStatus=iaw.store.select(["input","download-status"]),this.dlStatus.on("update",this.onDownloadStatus),iaw.store.get(["input","selected-item"])===i&&(this.active=!0,this.update());var o=!!e.__proto__.data,n=o?e.__proto__.data:this;if(iaw.libraryManager.isTemplateLicensed(n.id)){var s=this.root.querySelector(".template-grid-item--licensed");s.classList.remove("hidden")}else iaw.libraryManager.isTemplateDownloading(n.id)&&this.onDownloadStatus(iaw.libraryManager.getTemplateStatus(n.id))}else"before-unmount"===t&&this.off("*")}),this.onInput=function(e){t.active=e.data.currentData["selected-item"]===i,t.activeFilter=iaw.store.get(["input","active-filter"]),t.update()},this.onDownloadStatus=function(i){if(!t.downloadEnded){var o=i.data&&i.data.currentData||i,n=t.getData()||e.data;if(n&&o.templateId===n.id){switch(o.downloadStatus){case iaw.libraryManager.DOWNLOADED:return t.onDownloadEnd(),void t.update();case iaw.libraryManager.DOWNLOAD_ERR:return void t.showError(o.err)}if(0===o.progress||!t.downloadStarted)return void t.onDownloadStart({progress:o.progress||0,size:n.size});t.updateProgress(o),t.update()}}}}),riot.tag2("template-grid",'<span if="{activeFilter === \'recent\'}" class="template-grid__wrapper grid"><welcome-card close="{onWelcomeClose(Constants.localStorage.recent)}" show="{showWelcome(Constants.localStorage.recent)}"></welcome-card><div class="template-grid__section-header"><span class="template-grid__section-title" data-i18n="newdoc_your_recent_items"></span><span class="template-grid__section-count">({mixedItems.length})</span></div><div class="template-grid__container template-grid__container-recents"></div></span><span if="{activeFilter === \'saved\'}" class="template-grid__wrapper grid"><welcome-card close="{onWelcomeClose(Constants.localStorage.saved)}" show="{showWelcome(Constants.localStorage.saved)}"></welcome-card><div if="{presets.length > 0}" class="template-grid__section-header"><span class="template-grid__section-title" data-i18n="newdoc_saved_blank_documents"></span><span class="template-grid__section-count">({presets.length})</span></div><div class="template-grid__container template-grid__container-presets template-grid__container-presets--saved"><preset-grid-item each="{presets}" data="{this}"></preset-grid-item></div><span if="{showExpander}" onclick="{expandPresets}" class="template-grid__expander"><span data-i18n="newdoc_view_all"></span><i class="spc-icons">plus</i></span><div if="{templates.length > 0}" class="template-grid__section-header"><span class="template-grid__section-title" data-i18n="listview_template_tab_label"></span><span class="template-grid__section-count">({templates.length})</span></div><div class="template-grid__container template-grid__container-saved"><template-grid-item each="{templates}" data="{this}"></template-grid-item></div></span><span if="{activeFilter !== \'recent\' && activeFilter !== \'saved\'}" class="template-grid__wrapper grid"><div if="{presets.length > 0}" class="template-grid__section-header"><span class="template-grid__section-title" data-i18n="newdoc_blank_documents"></span><span class="template-grid__section-count">({presets.length})</span></div><div class="template-grid__container template-grid__container-presets"><preset-grid-item each="{presets}" data="{this}"></preset-grid-item></div><span if="{showExpander}" onclick="{expandPresets}" class="template-grid__expander"><span data-i18n="newdoc_view_all"></span><i class="spc-icons">plus</i></span><div if="{templates.length > 0}" class="template-grid__section-header"><span class="template-grid__section-title" data-i18n="listview_template_tab_label"></span><span class="template-grid__section-count">({templates.length})</span></div><div class="template-grid__container"><template-grid-item each="{templates}" data="{this}"></template-grid-item></div></span>',"",'onkeydown="{keyDown}"',function(e){var t=this;this.mixin("i18n"),this.mixin("cooldown"),this.templateCursor=null,this.allItemsNum=0,this.mixedItems=null,this.presets=null,this.templates=null,this.activeFilter="recent",this.showExpander=!1;var i,o=null;this.Constants={localStorage:{recent:"fnft.showWelcomeRecent",saved:"fnft.showWelcomeSaved",count:"fnft.displayCount"}},this.onWelcomeClose=function(e){return function(){iaw.localstorage.setUserItem(e,!1),iaw.analytics.ingest.logFNFTActionClickedEvent("welcome-closed",{activeFilter:iaw.store.get(["input","active-filter"])})}},this.rebuildItems=function(){var e,i,n,s,a=0,r=20;if("recent"===t.activeFilter){for(s=document.querySelector(".template-grid__container"),t.mixedItems=[];s.firstChild;)s.removeChild(s.firstChild);for(o.sort(function(e,t){return t.lastUsedTime-e.lastUsedTime}),e=0;e<o.length;e++)i=o[e],i.displayPosition=e,i.activeFilter=t.activeFilter,i.loggedIngestRendered||(iaw.analytics.ingest.logFNFTItemRenderedEvent(i),i.loggedIngestRendered=!0),(i.isPreset||iaw.libraryManager.isTemplateLicensed(i.id))&&(i.isPreset?(t.mixedItems.push(i),n=document.createElement("preset-grid-item"),riot.mount(n,{data:i}),s.appendChild(n)):(a<r&&(t.mixedItems.push(i),n=document.createElement("template-grid-item"),riot.mount(n,{data:i}),s.appendChild(n)),a++));t.showExpander=!1,riotctrl.trigger("show-stock-bar"),iaw.store.set(["activeTemplates"],t.mixedItems)}else{if(t.presets=[],t.templates=[],o&&o.length>0){for(e=0;e<o.length;e++)i=o[e],i.displayPosition=e,i.activeFilter=t.activeFilter,i.loggedIngestRendered||(iaw.analytics.ingest.logFNFTItemRenderedEvent(i),i.loggedIngestRendered=!0),i.isPreset?t.presets.push(i):t.templates.push(i);"saved"===t.activeFilter&&t.templates.length>0&&t.templates.sort(function(e,t){return e.licensedTime>t.licensedTime?-1:e.licensedTime<t.licensedTime?1:0})}t.templates.length>0?(t.showExpander=0===iaw.util.currentBreakPoint?t.presets.length>3:t.presets.length>4,riotctrl.trigger("show-stock-bar")):(t.showExpander=!1,t.expandPresetsInstant(),riotctrl.trigger("hide-stock-bar")),iaw.store.set(["activeTemplates"],t.templates)}t.update()},this.expandPresetsInstant=function(){if(!t.showExpander){var e=t.root.querySelector(".template-grid__container-presets");e.classList.add("template-grid__container-presets--open")}},this.expandPresets=function(e){var i=t.root.querySelector(".template-grid__expander");if(!i||i.classList.contains("anim--fade-out-fast"))return!1;var o=document.querySelector(".template-grid-item--active");if(o&&"template-grid-item"===o.tagName.toLowerCase()&&!(e instanceof MouseEvent))return!1;var n=t.root.querySelector(".template-grid__container-presets");return n.classList.add("template-grid__container-presets--open"),i.classList.add("anim--fade-out-fast"),iaw.analytics.ingest.logFNFTActionClickedEvent("preset-viewmore",{activeFilter:t.activeFilter}),!0},this.showWelcome=function(e){var i=iaw.localstorage.getUserItem(e);i="boolean"!=typeof i||i;var o=iaw.localstorage.getUserItem(t.Constants.localStorage.count);return i=!!i&&o<=3},this.keyDown=function(e){var i,o,n,s=e.target.parentNode,a=e.which||e.keyCode,r=Array.prototype.slice.call(s.parentNode.children),l=-1;switch(l=r.indexOf(s),a){case iaw.a11y.Keys.ENTER:case iaw.a11y.Keys.SPACE:s.click(),e.preventDefault();break;case iaw.a11y.Keys.END:i=r[r.length-1];break;case iaw.a11y.Keys.HOME:i=r[0];break;case iaw.a11y.Keys.LEFT:l>0&&(i=r[l-1]);break;case iaw.a11y.Keys.UP:i=iaw.a11y.getAdjacentElementVertically(r,s,!0),n=document.querySelectorAll(".template-grid__container")[0],!i&&n&&n!==s.parentNode&&(i=n.lastElementChild);break;case iaw.a11y.Keys.RIGHT:l<r.length-1&&(i=r[l+1]);break;case iaw.a11y.Keys.DOWN:i=iaw.a11y.getAdjacentElementVertically(r,s,!1),n=document.querySelectorAll(".template-grid__container")[1],t.expandPresets()||i||!n||n===s.parentNode||(i=n.firstElementChild);break;default:"keypress"===e.type&&(i=iaw.a11y.alphanumericSearch(e,r,s))}return i&&(o=iaw.a11y.focusable(i,!1,!0)[0],o&&o.querySelector("button").focus()),!0},this.selectFirstItem=function(){var e=document.querySelector(".template-grid__container"),i=e.firstElementChild;i||"recent"===t.activeFilter||(e=document.querySelectorAll(".template-grid__container")[1],i=e.firstElementChild),i&&(i=i._tag,i.autoClick())},this.selectPresetItem=function(e){for(var t=document.querySelector(".template-grid__container"),i=t.firstElementChild;i&&(i._tag||(i=i.nextSibling),i._tag.title!==e);)i=i.nextSibling;i&&(i=i._tag,i.autoClick(),setTimeout(function(){var e=document.querySelector(".scroll-container");e.scrollTop=i.root.offsetTop-100},300))},this.addTemplatesToSaved=function(e){var i=e.data&&e.data.currentData||e;if(i&&i.licensedTime&&i.downloadStatus&&i.downloadStatus!==iaw.libraryManager.DOWNLOAD_ERR&&"saved"===t.activeFilter){t.templates=t.templates||[];for(var o=0;o<t.templates.length;o++)if(t.templates[o].id===i.templateId)return;var n=iaw.util.getTemplateData(i.templateId);n&&(n.licensedTime=i.licensedTime,n.template_category.indexOf("saved")===-1&&n.template_category.push("saved"),t.templates.push(n),t.templates.sort(function(e,t){return t.licensedTime-e.licensedTime}),iaw.store.set(["activeTemplates"],t.templates),t.update())}},this.on("mount before-unmount",function(e){if("mount"===e){riotctrl.on("update-host-retro",this.onHost,this),riotctrl.on("resize-breakpoint",this.rebuildItems,this),riotctrl.on(iaw.fnftEvents.FILTER,this.onFilter,this),i=this.parent.root.querySelector(".scroll-container"),this.showWelcome(this.Constants.localStorage.recent)&&iaw.analytics.ingest.logFNFTActionClickedEvent("welcome-rendered",{displayCount:iaw.localstorage.getUserItem(this.Constants.localStorage.count),activeFilter:iaw.store.get(["input","active-filter"])});var t=iaw.store.select(["input","download-status"]);t.on("update",this.addTemplatesToSaved)}else"before-unmount"===e&&(this.templateCursor.release(),riotctrl.off("update-host-retro",this.onHost,this),riotctrl.off("resize-breakpoint",this.rebuildItems,this),riotctrl.off(iaw.fnftEvents.FILTER,this.onFilter,this),i=null,this.off("*"))}),this.onHost=function(){t.isMounted&&t.onFilter("recent"),t.templateCursor||(t.templateCursor=iaw.store.select("templates"),t.templateCursor.on("update",function(e){var t=iaw.store.get(["input","active-filter"]);this.onFilter(t)},{scope:t}))},this.onFilter=function(e,n,s){var a=iaw.store.get("presets"),r=iaw.store.get("templates"),l=null;if("recent"!==t.activeFilter){var c=t.root.querySelector(".template-grid__container-presets");c.classList.remove("template-grid__container-presets--open"),c=t.root.querySelector(".template-grid__expander"),c&&c.classList.remove("anim--fade-out-fast")}l=r?a.concat(r):a&&a.slice(0)||[],t.activeFilter=e,t.update(),o=l.filter(function(t){if(t.template_category instanceof Array){var i=t.template_category.join(",").toLowerCase().split(",");return i.indexOf(e)!==-1}return t.template_category===e}),o=o.filter(function(e,t){return t==o.indexOf(e)});var d;if(i){var u=iaw.store.get(["input","active-filter"]);u&&(d=i.scrollTop,iaw.store.set(["input","scroll-pos",u],d))}iaw.store.set(["input","active-filter"],e),t.rebuildItems(),!s&&n?(t.expandPresets(),t.selectPresetItem(n)):t.selectFirstItem(),i&&(d=iaw.store.get(["input","scroll-pos",e])||0,i.scrollTop=d)}}),riot.tag2("template-tab",'<i if="{type === \'recent\'}" class="inapp-icons inapp-icon--clock template-tab__item--recent" onclick="{onClick}"></i><a href="#" class="template-tab__item" role="tab" aria-selected="{active}" tabindex="{active ? \'0\' : \'-1\'}" onclick="{onClick}" data-i18n="{name}"></a><div if="{type === \'saved\'}" class="template-tab__separator"></div>',"",'class="template-tab {template-tab--active: active}"',function(e){var t=this;this.mixin("i18n"),this.inputCursor=null,this.active=!1,this.setLine=function(){var e=t.root.querySelector(".template-tab__item"),i=e.offsetWidth,o=e.offsetLeft,n=t.parent.root.querySelector(".spc-tabs__line");n.style.transform="translateX("+o+"px) scaleX("+i+")"},this.onClick=function(e){t.active||(riotctrl.trigger(iaw.fnftEvents.FILTER,t.type),iaw.analytics.ingest.logFNFTActionClickedEvent("tab-selected",{activeFilter:t.type}),iaw.analytics.pip.logFNFTDataGroupEvent("Pick Category",{category:t.type}),window.location.hash="",t.setLine())},this.on("mount before-unmount",function(e){if("mount"===e){var t=iaw.store.get(["input","active-filter"]);this.active=t===this.type,this.active&&this.setLine(),this.update(),this.inputCursor=iaw.store.select("input"),this.inputCursor.on("update",this.onInput)}else"before-unmount"===e&&(this.inputCursor.release(),this.off("*"))}),this.onInput=function(e){t.active=e.data.currentData["active-filter"]===t.type,t.active&&t.setLine(),t.update()}}),riot.tag2("welcome-card",'<div class="grid-spanning-card__content"><div class="welcome-card__titlebar"><span class="spc-layout-spacer"></span><button class="welcome-card__close-btn" tabindex="-1" onclick="{close}"><i class="spc-icons">X</i></button></div><h4 class="welcome-card__title">{title}</h4><span class="welcome-card__content"></span></div>',"",'class="welcome-card grid-spanning-card invisible"',function(e){var t=this;this.title="",this.close=function(){t.root.classList.add("hidden"),t.opts.close&&"function"==typeof t.opts.close&&t.opts.close()},this.on("mount",function(){riotctrl.on("markdown-ready-retro",this.onMD,this),this.filterCursor=iaw.store.select(["input","active-filter"]),this.filterCursor.on("update",this.onMD,{scope:this})}),this.on("before-unmount",function(){riotctrl.off("markdown-ready-retro",this.onMD,this),this.filterCursor.release(),this.off("*")}),this.onMD=function(e){if("undefined"!=typeof marked){var i,o=e&&e.data?e.data.currentData:e;o||(o="recent");var n=iaw.store.get("activeTemplates");if("recent"===o)t.title=iaw.i18n.getLocalizedString("newdoc_welcome_banner_recent_title"),i=n&&n.length?iaw.i18n.getLocalizedString("newdoc_welcome_banner_content_recent_templates"):iaw.i18n.getLocalizedString("newdoc_welcome_banner_content_recent_no_templates");else{t.title=iaw.i18n.getLocalizedString("newdoc_welcome_banner_saved_title");var s=iaw.store.get(["host","hostID"]);i="ILST"===s?iaw.i18n.getLocalizedString("newdoc_welcome_banner_content_saved_templates_ai"):n&&n.length?iaw.i18n.getLocalizedString("newdoc_welcome_banner_content_saved_templates"):iaw.i18n.getLocalizedString("newdoc_welcome_banner_content_saved_no_templates")}var a=t.root.querySelector(".welcome-card__content");a.innerHTML=marked(i),t.root.classList.remove("invisible"),t.root.classList.add("anim--fade-in"),t.update()}}});